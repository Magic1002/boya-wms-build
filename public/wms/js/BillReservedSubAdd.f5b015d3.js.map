{"version":3,"sources":["webpack:///./src/views/out-bound/reservation-form/childEdit/index.vue?a266","webpack:///./src/views/out-bound/reservation-form/childEdit/index.vue?c537","webpack:///src/views/out-bound/reservation-form/childEdit/index.vue","webpack:///./src/views/out-bound/reservation-form/childEdit/index.vue?6826","webpack:///./src/views/out-bound/reservation-form/childEdit/index.vue","webpack:///./src/apis/modules/out-bound/reservation-sub-orders.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","extraInfo","ref","form","rules","staticStyle","includes","pageType","model","value","callback","$$v","$set","expression","detailList","columnList","expandList","on","handleRowClick","searchInit","scopedSlots","_u","key","fn","scope","$event","handleDelete","$index","_v","staticClass","_e","buttonLoading","onAudit","onSave","goBack","staticRenderFns","components","AuditWrapper","mixins","paginationPage","props","data","query","tableData","INIT_FORM","needDate","message","computed","$route","type","name","replace","toLowerCase","mounted","getDetail","methods","column","label","$confirm","confirmButtonText","cancelButtonText","cancelButtonClass","lockScroll","Promise","add","edit","$refs","formName","validate","valid","isNo0","Api","code","$store","dispatch","tempRoute","resetFields","$router","go","1","0","2","component","getSonPullApi","request","url","method","getListApi","AddApi","editApi","deleteApi","getDetailApi","printApi","submitApi","withdrawApi","auditApi"],"mappings":"sHAAA,yBAA8sB,EAAG,G,kECAjtB,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,gBAAgB,CAACE,MAAM,CAAC,aAAaN,EAAIO,YAAY,CAACH,EAAG,UAAU,CAACI,IAAI,OAAOF,MAAM,CAAC,MAAQN,EAAIS,KAAK,OAAS,GAAG,MAAQT,EAAIU,QAAQ,CAACN,EAAG,SAAS,CAACA,EAAG,SAAS,CAACE,MAAM,CAAC,GAAK,GAAG,GAAK,GAAG,GAAK,GAAG,GAAK,GAAG,GAAK,KAAK,CAACF,EAAG,eAAe,CAACE,MAAM,CAAC,MAAQ,OAAO,KAAO,aAAa,CAACF,EAAG,iBAAiB,CAACO,YAAY,CAAC,MAAQ,SAASL,MAAM,CAAC,KAAO,OAAO,eAAe,aAAa,YAAc,UAAU,SAAW,CAAC,QAAS,UAAUM,SAASZ,EAAIa,WAAWC,MAAM,CAACC,MAAOf,EAAIS,KAAa,SAAEO,SAAS,SAAUC,GAAMjB,EAAIkB,KAAKlB,EAAIS,KAAM,WAAYQ,IAAME,WAAW,oBAAoB,IAAI,GAAGf,EAAG,SAAS,CAACO,YAAY,CAAC,gBAAgB,QAAQL,MAAM,CAAC,GAAK,GAAG,GAAK,GAAG,GAAK,GAAG,GAAK,GAAG,GAAK,KAAK,CAACF,EAAG,YAAY,CAACI,IAAI,eAAeF,MAAM,CAAC,SAAU,EAAM,OAAQ,EAAK,WAAY,EAAM,aAAaN,EAAIS,KAAKW,WAAW,cAAcpB,EAAIqB,WAAW,kBAAkB,IAAI,cAAcrB,EAAIsB,WAAW,qBAAoB,EAAM,oBAAoB,IAAI,gBAAgB,CAAC,QAAS,SAAU,QAAQV,SAASZ,EAAIa,WAAWU,GAAG,CAAC,SAAWvB,EAAIwB,eAAe,QAAUxB,EAAIyB,YAAYC,YAAY1B,EAAI2B,GAAG,CAAC,CAACC,IAAI,UAAUC,GAAG,SAASC,GAAO,MAAO,CAAC1B,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAUiB,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO/B,EAAIgC,aAAaF,EAAMG,WAAW,CAACjC,EAAIkC,GAAG,gBAAgB,GAAqB,UAAjBlC,EAAIa,SAAsBT,EAAG,SAAS,CAACO,YAAY,CAAC,gBAAgB,QAAQL,MAAM,CAAC,GAAK,GAAG,GAAK,GAAG,GAAK,GAAG,GAAK,GAAG,GAAK,KAAK,CAACF,EAAG,eAAe,CAAC+B,YAAY,mBAAmB7B,MAAM,CAAC,KAAO,UAAU,MAAQ,UAAU,CAACF,EAAG,WAAW,CAACE,MAAM,CAAC,KAAO,WAAW,YAAc,UAAU,KAAO,GAAGQ,MAAM,CAACC,MAAOf,EAAIS,KAAY,QAAEO,SAAS,SAAUC,GAAMjB,EAAIkB,KAAKlB,EAAIS,KAAM,UAAWQ,IAAME,WAAW,mBAAmB,IAAI,GAAGnB,EAAIoC,MAAM,GAAGhC,EAAG,MAAM,CAAC+B,YAAY,eAAe,CAAmB,UAAjBnC,EAAIa,SAAsB,CAACT,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,QAAUN,EAAIqC,eAAed,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO/B,EAAIsC,QAAQ,MAAM,CAACtC,EAAIkC,GAAG,SAAS9B,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,SAAS,QAAUN,EAAIqC,eAAed,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO/B,EAAIsC,QAAQ,MAAM,CAACtC,EAAIkC,GAAG,SAAS9B,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,QAAUN,EAAIqC,eAAed,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO/B,EAAIsC,QAAQ,MAAM,CAACtC,EAAIkC,GAAG,YAAYlC,EAAIoC,KAAuB,QAAjBpC,EAAIa,SAAoB,CAACT,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,QAAUN,EAAIqC,eAAed,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO/B,EAAIuC,OAAO,WAAW,CAACvC,EAAIkC,GAAG,UAAUlC,EAAIoC,KAAuB,SAAjBpC,EAAIa,SAAqB,CAACT,EAAG,YAAY,CAACE,MAAM,CAAC,KAAO,UAAU,QAAUN,EAAIqC,eAAed,GAAG,CAAC,MAAQ,SAASQ,GAAQ,OAAO/B,EAAIuC,OAAO,WAAW,CAACvC,EAAIkC,GAAG,UAAUlC,EAAIoC,KAAKhC,EAAG,YAAY,CAACE,MAAM,CAAC,QAAUN,EAAIqC,eAAed,GAAG,CAAC,MAAQvB,EAAIwC,SAAS,CAACxC,EAAIkC,GAAG,SAAS,IAAI,IAAI,IACrsFO,EAAkB,G,6vBCyEtB,wBACA,YACA,WACA,gBAGA,GACEC,WAAY,CACVC,aAAJ,QAEEC,OAAQ,CAACC,EAAX,MACEC,MAAO,GACPC,KANF,WAMA,WACI,MAAO,CACLC,MAAO,GACPC,UAAW,GACX5B,WAAY,CAClB,CACQ,OAAR,OACQ,KAAR,oBACQ,MAAR,MACQ,MAAR,SAGQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,UAEA,CACQ,OAAR,OACQ,KAAR,oBACQ,MAAR,QACQ,MAAR,SACQ,SAAR,GACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,UAEA,CACQ,OAAR,OACQ,KAAR,eACQ,MAAR,OACQ,MAAR,SACQ,SAAR,GACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,UAEA,CACQ,OAAR,OACQ,KAAR,eACQ,MAAR,OACQ,MAAR,SACQ,SAAR,GACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,UAEA,CACQ,OAAR,OACQ,KAAR,sBACQ,MAAR,OACQ,MAAR,SACQ,SAAR,GACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,YAAR,UAEA,CACQ,OAAR,OACQ,KAAR,WACQ,MAAR,KACQ,MAAR,SACQ,SAAR,GACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,UAcM,CACE,OAAR,OACQ,KAAR,WACQ,MAAR,OACQ,MAAR,SACQ,SAAR,GACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,UAcM,CACE,OAAR,SACQ,KAAR,UACQ,MAAR,OACQ,MAAR,SACQ,SAAR,IACQ,OAAR,EACQ,UAAR,EACQ,WAAR,EACQ,UAAR,KACQ,YAAR,SACQ,OAAR,YAAU,OAAV,GACQ,SAAR,YAAU,MAAV,yCACQ,OAAR,YAAU,OAAV,eACQ,aAAR,6BAEA,KACQ,aAAR,YAAU,OAAV,KAGMC,WAAY,GACZb,KAAMyC,IACNxC,MAAO,CACLyC,SAAU,CAClB,CAAU,UAAV,EAAU,QAAV,UAAU,QAAV,WAEQC,QAAS,CACjB,CAAU,UAAV,EAAU,QAAV,UAAU,QAAV,UAGMf,eAAe,EACf9B,UAAW,OAGf8C,SAAU,CACRxC,SADJ,WAGM,MAA+B,iBAA3BZ,KAAKqD,OAAON,MAAMO,KAAgC,SAC/CtD,KAAKqD,OAAOE,KAAKC,QAAQ,kBAAmB,IAAIC,eAAiB,QAG5EC,QAhKF,WAiKsB,QAAlB1D,KAAKY,UAAsBZ,KAAK2D,aAElCC,QAAS,CACPrC,eADJ,YACA,oCAEM,GAAqB,OAAjBsC,EAAOC,MACT,OAAO,GAIX/B,aARJ,SAQA,cACM/B,KAAK+D,SAAS,qBAApB,MACQC,kBAAmB,MACnBC,iBAAkB,MAClBC,kBAAmB,oBACnBZ,KAAM,UACNa,YAAY,IACpB,iBACQ,EAAR,4BACQ,EAAR,UACUb,KAAM,UACNH,QAAS,YAEnB,kBACQ,EAAR,UACUA,QAAS,QACTG,KAAM,aAKZK,UA7BJ,WA6BA,WACM,OAAO,IAAIS,SAAQ,SAAzB,KACQ,OAAR,OAAQ,CAAR,uCACA,kBAAU,IACV,kBACA,IACY,EAAZ,WACY,EAAZ,iBACY,EAAZ,OAGA,mBAEU,EAAV,UAII9B,OA9CJ,SA8CA,cACA,GACQ+B,IAAK,EAAb,KACQC,KAAM,EAAd,MAEA,mBACMtE,KAAKuE,MAAMC,GAAUC,UAAS,SAApC,GACQ,IAAIC,EAoCF,OAAO,EAnCP,GAAK,EAAf,uBAAU,CAOA,IAAV,0DAEcC,EACF,EAAZ,UACcxB,QAAS,qBACTG,KAAM,aAIV,EAAV,iBACUsB,EAAI,EAAd,GACA,SACA,sBACA,SACiBC,IACH,EAAd,UACgB1B,QAAS,OACTG,KAAM,YAER,EAAd,UAEY,EAAZ,oBACA,mBAEY,EAAZ,0BA9BY,EAAZ,UACcH,QAAS,WACTG,KAAM,gBAqChBf,OA9FJ,WA+FM,IAAN,gCACMvC,KAAK8E,OAAOC,SAAS,mBAAoBC,GACzChF,KAAKuE,MAAM/D,KAAKyE,cAChBjF,KAAKQ,KAAOyC,IAGZjD,KAAKkF,QAAQC,IAAI,IAGnB9C,QAxGJ,SAwGA,cACA,GACQ+C,EAAG,kBACHC,EAAG,iBACHC,EAAG,mBACX,GACMtF,KAAKuE,MAAM/D,KAAKiE,SAAtB,6KACA,EADA,iEAEA,kCACA,wBACA,uBACA,eACA,sCACA,iBAPA,UAEA,EAFA,OASA,UATA,wDAUA,mBACA,qBAXA,EAYA,iBAZA,EAYA,aAZA,EAYA,SAZA,EAYA,kBAZA,UAaA,+BACA,aACA,aACA,SACA,oBACA,WACA,0BAnBA,WAaA,EAbA,OAqBA,mBACA,UAtBA,mDAuBA,YACA,eACA,iBAEA,WA3BA,sGCjW+Z,I,wBCQ3Zc,EAAY,eACd,EACAzF,EACA0C,GACA,EACA,KACA,WACA,MAIa,aAAA+C,E,2CCnBf,oWAIO,SAASC,IAAyB,IAAX1C,EAAW,uDAAJ,GACnC,OAAO2C,eAAQ,CACbC,IAAK,4CACLC,OAAQ,OACR7C,SAIG,SAAS8C,IAAsB,IAAX9C,EAAW,uDAAJ,GAChC,OAAO2C,eAAQ,CACbC,IAAK,4CACLC,OAAQ,OACR7C,SAIG,SAAS+C,IAAkB,IAAX/C,EAAW,uDAAJ,GAC5B,OAAO2C,eAAQ,CACbC,IAAK,uCACLC,OAAQ,OACR7C,SAIG,SAASgD,IAAmB,IAAXhD,EAAW,uDAAJ,GAC7B,OAAO2C,eAAQ,CACbC,IAAK,wCACLC,OAAQ,OACR7C,SAIG,SAASiD,IAAqB,IAAXjD,EAAW,uDAAJ,GAC/B,OAAO2C,eAAQ,CACbC,IAAK,0CACLC,OAAQ,OACR7C,SAIG,SAASkD,IAAwB,IAAXlD,EAAW,uDAAJ,GAClC,OAAO2C,eAAQ,CACbC,IAAK,0CACLC,OAAQ,OACR7C,SAIG,SAASmD,IAAoB,IAAXnD,EAAW,uDAAJ,GAC9B,OAAO2C,eAAQ,CACbC,IAAK,yCACLC,OAAQ,OACR7C,SAIG,SAASoD,IAAqB,IAAXpD,EAAW,uDAAJ,GAC/B,OAAO2C,eAAQ,CACbC,IAAK,0CACLC,OAAQ,OACR7C,SAIG,SAASqD,IAAuB,IAAXrD,EAAW,uDAAJ,GACjC,OAAO2C,eAAQ,CACbC,IAAK,4CACLC,OAAQ,OACR7C,SAIG,SAASsD,IAAoB,IAAXtD,EAAW,uDAAJ,GAC9B,OAAO2C,eAAQ,CACbC,IAAK,yCACLC,OAAQ,OACR7C","file":"js/BillReservedSubAdd.f5b015d3.js","sourcesContent":["import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/style-resources-loader/lib/index.js??ref--8-oneOf-1-4!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=0c622462&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/style-resources-loader/lib/index.js??ref--8-oneOf-1-4!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=0c622462&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('audit-wrapper',{attrs:{\"extra-info\":_vm.extraInfo}},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"inline\":\"\",\"rules\":_vm.rules}},[_c('el-row',[_c('el-col',{attrs:{\"xs\":24,\"sm\":24,\"md\":24,\"lg\":24,\"xl\":24}},[_c('el-form-item',{attrs:{\"label\":\"需求日期\",\"prop\":\"needDate\"}},[_c('el-date-picker',{staticStyle:{\"width\":\"178px\"},attrs:{\"type\":\"date\",\"value-format\":\"yyyy-MM-dd\",\"placeholder\":\"请选择交货日期\",\"disabled\":['audit', 'detail'].includes(_vm.pageType)},model:{value:(_vm.form.needDate),callback:function ($$v) {_vm.$set(_vm.form, \"needDate\", $$v)},expression:\"form.needDate\"}})],1)],1),_c('el-col',{staticStyle:{\"margin-bottom\":\"15px\"},attrs:{\"xs\":24,\"sm\":24,\"md\":24,\"lg\":24,\"xl\":24}},[_c('table-com',{ref:\"baseTableRef\",attrs:{\"loading\":false,\"index\":true,\"selection\":false,\"table-data\":_vm.form.detailList,\"column-list\":_vm.columnList,\"operation-width\":190,\"expand-list\":_vm.expandList,\"table-column-sort\":false,\"table-height-type\":680,\"show-operate\":!['audit', 'detail', 'edit'].includes(_vm.pageType)},on:{\"rowClick\":_vm.handleRowClick,\"refresh\":_vm.searchInit},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDelete(scope.$index)}}},[_vm._v(\"删除\")])]}}])})],1),(_vm.pageType === 'audit')?_c('el-col',{staticStyle:{\"margin-bottom\":\"15px\"},attrs:{\"xs\":24,\"sm\":24,\"md\":24,\"lg\":24,\"xl\":24}},[_c('el-form-item',{staticClass:\"approval-opinion\",attrs:{\"prop\":\"message\",\"label\":\"审批意见：\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"placeholder\":\"请填写审批意见\",\"rows\":5},model:{value:(_vm.form.message),callback:function ($$v) {_vm.$set(_vm.form, \"message\", $$v)},expression:\"form.message\"}})],1)],1):_vm._e()],1),_c('div',{staticClass:\"btn-context\"},[(_vm.pageType === 'audit')?[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.buttonLoading},on:{\"click\":function($event){return _vm.onAudit(1)}}},[_vm._v(\"通 过\")]),_c('el-button',{attrs:{\"type\":\"danger\",\"loading\":_vm.buttonLoading},on:{\"click\":function($event){return _vm.onAudit(0)}}},[_vm._v(\"驳 回\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.buttonLoading},on:{\"click\":function($event){return _vm.onAudit(2)}}},[_vm._v(\"不 通 过\")])]:_vm._e(),(_vm.pageType === 'add')?[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.buttonLoading},on:{\"click\":function($event){return _vm.onSave('form')}}},[_vm._v(\"保 存\")])]:_vm._e(),(_vm.pageType === 'edit')?[_c('el-button',{attrs:{\"type\":\"primary\",\"loading\":_vm.buttonLoading},on:{\"click\":function($event){return _vm.onSave('form')}}},[_vm._v(\"保 存\")])]:_vm._e(),_c('el-button',{attrs:{\"loading\":_vm.buttonLoading},on:{\"click\":_vm.goBack}},[_vm._v(\"取消\")])],2)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <audit-wrapper :extra-info=\"extraInfo\">\r\n    <el-form ref=\"form\" :model=\"form\" inline :rules=\"rules\">\r\n      <el-row>\r\n        <el-col :xs=\"24\" :sm=\"24\" :md=\"24\" :lg=\"24\" :xl=\"24\">\r\n          <el-form-item label=\"需求日期\" prop=\"needDate\">\r\n            <el-date-picker\r\n              v-model=\"form.needDate\"\r\n              type=\"date\"\r\n              style=\"width: 178px;\"\r\n              value-format=\"yyyy-MM-dd\"\r\n              placeholder=\"请选择交货日期\"\r\n              :disabled=\"['audit', 'detail'].includes(pageType)\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :xs=\"24\" :sm=\"24\" :md=\"24\" :lg=\"24\" :xl=\"24\" style=\"margin-bottom: 15px;\">\r\n          <table-com\r\n            ref=\"baseTableRef\"\r\n            :loading=\"false\"\r\n            :index=\"true\"\r\n            :selection=\"false\"\r\n            :table-data=\"form.detailList\"\r\n            :column-list=\"columnList\"\r\n            :operation-width=\"190\"\r\n            :expand-list=\"expandList\"\r\n            :table-column-sort=\"false\"\r\n            :table-height-type=\"680\"\r\n            :show-operate=\"!['audit', 'detail', 'edit'].includes(pageType)\"\r\n            @rowClick=\"handleRowClick\"\r\n            @refresh=\"searchInit\"\r\n          >\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"danger\" @click=\"handleDelete(scope.$index)\">删除</el-button>\r\n            </template>\r\n          </table-com>\r\n        </el-col>\r\n        <el-col v-if=\"pageType === 'audit'\" style=\"margin-bottom: 15px;\" :xs=\"24\" :sm=\"24\" :md=\"24\" :lg=\"24\" :xl=\"24\">\r\n          <el-form-item prop=\"message\" label=\"审批意见：\" class=\"approval-opinion\">\r\n            <el-input\r\n              v-model=\"form.message\"\r\n              type=\"textarea\"\r\n              placeholder=\"请填写审批意见\"\r\n              :rows=\"5\"\r\n            />\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <div class=\"btn-context\">\r\n        <template v-if=\"pageType === 'audit'\">\r\n          <el-button type=\"primary\" :loading=\"buttonLoading\" @click=\"onAudit(1)\">通 过</el-button>\r\n          <el-button type=\"danger\" :loading=\"buttonLoading\" @click=\"onAudit(0)\">驳 回</el-button>\r\n          <el-button type=\"primary\" :loading=\"buttonLoading\" @click=\"onAudit(2)\">不 通 过</el-button>\r\n        </template>\r\n        <template v-if=\"pageType === 'add'\">\r\n          <el-button type=\"primary\" :loading=\"buttonLoading\" @click=\"onSave('form')\">保 存</el-button>\r\n        </template>\r\n        <template v-if=\"pageType === 'edit'\">\r\n          <el-button type=\"primary\" :loading=\"buttonLoading\" @click=\"onSave('form')\">保 存</el-button>\r\n        </template>\r\n        <el-button :loading=\"buttonLoading\" @click=\"goBack\">取消</el-button>\r\n      </div>\r\n    </el-form>\r\n  </audit-wrapper>\r\n</template>\r\n\r\n<script>\r\nimport AuditWrapper from '@/components/AuditWrapper'\r\nimport _ from 'lodash'\r\nimport paginationPage from '@/mixins/paginationPage'\r\nimport { AddApi as addListApi, editApi as updateListApi, getDetailApi, auditApi } from '@/apis/modules/out-bound/reservation-sub-orders'\r\nimport { requestWrapper, promiseWrapper } from '@/utils/utils'\r\n// import { getLocalTime } from '@/filters'\r\n// import { debounceS } from '@/utils'\r\nconst INIT_FORM = () => ({\r\n  needDate: '', // 需求日期\r\n  message: '', // 审批意见\r\n  detailList: [] // 物料列表\r\n})\r\n\r\nexport default {\r\n  components: {\r\n    AuditWrapper\r\n  },\r\n  mixins: [paginationPage],\r\n  props: {},\r\n  data() {\r\n    return {\r\n      query: {},\r\n      tableData: [],\r\n      columnList: [\r\n        {\r\n          module: 'word',\r\n          prop: 'materialGroupCode',\r\n          label: '物料组',\r\n          align: 'center',\r\n          // width: 120,\r\n          // minWidth: 160,\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center'\r\n        },\r\n        {\r\n          module: 'word',\r\n          prop: 'materialGroupDesc',\r\n          label: '物料组描述',\r\n          align: 'center',\r\n          minWidth: '',\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center'\r\n        },\r\n        {\r\n          module: 'word',\r\n          prop: 'materialCode',\r\n          label: '物料编码',\r\n          align: 'center',\r\n          minWidth: '',\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center'\r\n        },\r\n        {\r\n          module: 'word',\r\n          prop: 'materialName',\r\n          label: '物料名称',\r\n          align: 'center',\r\n          minWidth: '',\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center'\r\n        },\r\n        {\r\n          module: 'word',\r\n          prop: 'assessType_dictText',\r\n          label: '评估类型',\r\n          align: 'center',\r\n          minWidth: '',\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          headerAlign: 'center'\r\n        },\r\n        {\r\n          module: 'word',\r\n          prop: 'unitName',\r\n          label: '单位',\r\n          align: 'center',\r\n          minWidth: '',\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center'\r\n        },\r\n        // {\r\n        //   module: 'word',\r\n        //   prop: 'sendNum',\r\n        //   label: '已发数量',\r\n        //   align: 'center',\r\n        //   minWidth: '',\r\n        //   fixed: false,\r\n        //   sortable: false,\r\n        //   resizable: true,\r\n        //   formatter: null,\r\n        //   headerAlign: 'center'\r\n        // },\r\n        {\r\n          module: 'word',\r\n          prop: 'needDate',\r\n          label: '需求日期',\r\n          align: 'center',\r\n          minWidth: '',\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center'\r\n        },\r\n        // {\r\n        //   module: 'word',\r\n        //   prop: 'inventoryNum',\r\n        //   label: '库存数量',\r\n        //   align: 'center',\r\n        //   minWidth: 160,\r\n        //   fixed: false,\r\n        //   sortable: false,\r\n        //   resizable: true,\r\n        //   formatter: null,\r\n        //   headerAlign: 'center'\r\n        // },\r\n        {\r\n          module: 'number',\r\n          prop: 'needNum',\r\n          label: '需求数量',\r\n          align: 'center',\r\n          minWidth: 160,\r\n          fixed: false,\r\n          sortable: false,\r\n          resizable: true,\r\n          formatter: null,\r\n          headerAlign: 'center',\r\n          setMin: (item) => 0,\r\n          disabled: (item) => ['audit', 'detail'].includes(this.pageType),\r\n          setMax: (item) => item.allowMaxNum,\r\n          handleChange: _.throttle((item) => {\r\n            console.log('执行了组件的修改,', item)\r\n          }, 1000),\r\n          setPrecision: (item) => 3\r\n        }\r\n      ],\r\n      expandList: [],\r\n      form: INIT_FORM(),\r\n      rules: {\r\n        needDate: [\r\n          { required: true, message: '请选择需求日期', trigger: 'change' }\r\n        ],\r\n        message: [\r\n          { required: true, message: '请填写审批意见', trigger: 'blur' }\r\n        ]\r\n      },\r\n      buttonLoading: false,\r\n      extraInfo: null\r\n    }\r\n  },\r\n  computed: {\r\n    pageType() {\r\n      // 如果页面链路走向是 待办弹窗->《已办理业务》，操作列小眼睛跳转到当前单据的详情页\r\n      if (this.$route.query.type === 'auditHistory') return 'detail'\r\n      return this.$route.name.replace('BillReservedSub', '').toLowerCase() || 'add'\r\n    }\r\n  },\r\n  mounted() {\r\n    this.pageType !== 'add' && this.getDetail()\r\n  },\r\n  methods: {\r\n    handleRowClick({ row, column, cell, event }) {\r\n      console.log(row)\r\n      if (column.label === '操作') {\r\n        return false\r\n      }\r\n    },\r\n    // 删除\r\n    handleDelete(i) {\r\n      this.$confirm(`此操作将永久删除该物料, 是否继续?`, '提示', {\r\n        confirmButtonText: '确 定',\r\n        cancelButtonText: '取 消',\r\n        cancelButtonClass: 'btn-custom-cancel',\r\n        type: 'warning',\r\n        lockScroll: false\r\n      }).then(() => {\r\n        this.form.detailList.splice(i, 1)\r\n        this.$message({\r\n          type: 'success',\r\n          message: '操作成功'\r\n        })\r\n      }).catch(() => {\r\n        this.$message({\r\n          message: '已取消删除',\r\n          type: 'info'\r\n        })\r\n      })\r\n    },\r\n    // 详情\r\n    getDetail() {\r\n      return new Promise((resolve, reject) => {\r\n        getDetailApi({ subNumber: this.$route.query.billNumber })\r\n          .then(res => {\r\n            const { code, data } = res\r\n            if (!code) {\r\n              this.form = data || {}\r\n              this.extraInfo = res.data\r\n              resolve(res)\r\n            }\r\n          })\r\n          .catch(err => {\r\n            console.log(err)\r\n            reject(err)\r\n          })\r\n      })\r\n    },\r\n    onSave(formName) {\r\n      const obj = {\r\n        add: addListApi,\r\n        edit: updateListApi\r\n      }\r\n      const Api = obj[this.pageType]\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          if (!this.form.detailList.length) {\r\n            this.$message({\r\n              message: '至少新增一条物料',\r\n              type: 'warning'\r\n            })\r\n            return\r\n          }\r\n          const isNo0 = this.form.detailList.some(c => !c.needNum)\r\n          console.log('this.form.detailList: ', this.form.detailList)\r\n          if (isNo0) {\r\n            this.$message({\r\n              message: '需求数量存在为0的情况，请重新编辑！',\r\n              type: 'warning'\r\n            })\r\n            return\r\n          }\r\n          this.buttonLoading = true\r\n          Api({\r\n            ...this.form\r\n          }).then(res => {\r\n            const { code } = res\r\n            if (!code) {\r\n              this.$message({\r\n                message: `操作成功`,\r\n                type: 'success'\r\n              })\r\n              this.goBack()\r\n            }\r\n            this.buttonLoading = false\r\n          }).catch(err => {\r\n            console.log(err)\r\n            this.buttonLoading = false\r\n          })\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    },\r\n    // Tip 回退页面\r\n    goBack() {\r\n      const tempRoute = Object.assign({}, this.$route)\r\n      this.$store.dispatch('tagsView/delView', tempRoute)\r\n      this.$refs.form.resetFields()\r\n      this.form = INIT_FORM()\r\n      //   const whiteList = ['add', 'edit', 'detail']\r\n      //   whiteList.includes(this.pageType) ? this.$router.push({ name: 'OutBoundOutsourcing' }) : this.$router.go(-1)\r\n      this.$router.go(-1)\r\n    },\r\n    // Tip 审批->通过 驳回 不通过\r\n    onAudit(auditType) {\r\n      const message = {\r\n        1: '该工单即将审批通过，是否继续？',\r\n        0: '该工单即将驳回, 是否继续?',\r\n        2: '该工单即将不通过, 是否继续?'\r\n      }[auditType]\r\n      this.$refs.form.validate(async valid => {\r\n        if (!valid) return\r\n        const diag = await promiseWrapper(this.$confirm(message, '提示', {\r\n          confirmButtonText: '确 定',\r\n          cancelButtonText: '取 消',\r\n          type: 'warning',\r\n          cancelButtonClass: 'btn-custom-cancel',\r\n          lockScroll: false\r\n        }))\r\n        if (!diag.success) return\r\n        this.buttonLoading = true\r\n        const { id: businessId } = this.$route.params\r\n        const { billNumber, taskId, processInstanceId } = this.$route.query\r\n        const res = await requestWrapper(auditApi({\r\n          businessId, // 业务ID\r\n          billNumber, // 单据编号\r\n          taskId, // 任务ID\r\n          processInstanceId, // 流程实例的ID\r\n          approval: auditType, // 审批标识\r\n          message: this.form.message // 审批意见\r\n        }))\r\n        this.buttonLoading = false\r\n        if (!res.success) return\r\n        this.$message({\r\n          message: '操作成功',\r\n          type: 'success'\r\n        })\r\n        this.goBack()\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.btn-context {\r\ntext-align: right;\r\n}\r\n::v-deep .approval-opinion {\r\n    margin: 0;\r\n    width: 100%;\r\n    .el-form-item__content {\r\n        width: 100%;\r\n    }\r\n}\r\n</style>\r\n\r\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=0c622462&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=0c622462&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0c622462\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/apis/request.wms'\r\n// Tip 出库管理/预留单 预留单子单\r\n\r\n// 下拉\r\nexport function getSonPullApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/listItem',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 列表\r\nexport function getListApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/pageList',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 新增\r\nexport function AddApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/add',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 修改\r\nexport function editApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/edit',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 删除\r\nexport function deleteApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/delete',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 详情\r\nexport function getDetailApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/detail',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 打印\r\nexport function printApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/print',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 提交\r\nexport function submitApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/submit',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 撤回\r\nexport function withdrawApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/withdraw',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n// 审核->通过、驳回、未通过\r\nexport function auditApi(data = {}) {\r\n  return request({\r\n    url: '/outWarehouse/wmsBillReservedSub/audit',\r\n    method: 'post',\r\n    data\r\n  })\r\n}\r\n\r\n"],"sourceRoot":""}