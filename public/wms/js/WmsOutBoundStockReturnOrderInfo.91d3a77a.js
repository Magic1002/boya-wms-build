(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["WmsOutBoundStockReturnOrderInfo"],{"8a18":function(e,t,r){"use strict";var n=r("9dc3"),i=r.n(n);i.a},"9dc3":function(e,t,r){},e001:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-row",{staticClass:"clearfix"},[r("div",{staticClass:"fl"},[r("el-button",{on:{click:e.handleGoBack}},[e._v("返回")])],1),r("div",{staticClass:"fr"},[r("el-button",{attrs:{disabled:1===e.form.status||2===e.form.status,type:"warning",icon:"el-icon-circle-check"},on:{click:e.handleEffect}},[e._v("生效")]),r("el-button",{attrs:{disabled:0===e.form.status||2===e.form.status,type:"primary",icon:"el-icon-check"},on:{click:e.handleFinish}},[e._v("完成")])],1)]),r("el-form",{ref:"form",attrs:{inline:"",model:e.form,rules:e.rules,"label-width":"80px","label-position":"left"}},[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"退库单号",prop:"billNumber"}},[r("el-input",{staticStyle:{width:"178px"},attrs:{disabled:"",placeholder:"请填写退库单号"},model:{value:e.form.billNumber,callback:function(t){e.$set(e.form,"billNumber",t)},expression:"form.billNumber"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"退库日期",prop:"date"}},[r("el-input",{staticStyle:{width:"178px"},attrs:{disabled:"",placeholder:"请填写退库日期"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"出库单号"}},[r("el-input",{staticStyle:{width:"178px"},attrs:{disabled:"",placeholder:"请填写出库单号"},model:{value:e.form.stockOutNumber,callback:function(t){e.$set(e.form,"stockOutNumber",t)},expression:"form.stockOutNumber"}})],1)],1),r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"是否检验",prop:"inspect"}},[r("el-radio-group",{staticClass:"my-inspect-sty",staticStyle:{width:"178px"},on:{input:e.inspectChange},model:{value:e.form.inspect,callback:function(t){e.$set(e.form,"inspect",t)},expression:"form.inspect"}},[r("el-radio-button",{attrs:{label:!0}},[e._v("是")]),r("el-radio-button",{attrs:{label:!1}},[e._v("否")])],1)],1)],1)],1)],1),r("el-row",[r("table-com",{ref:"baseTableRef",attrs:{loading:e.loading,index:!0,selection:!1,"table-data":e.form.detailList,"column-list":e.columnList,"operation-width":120,"table-height-type":685,"table-column-sort":!1},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"warning",icon:"el-icon-edit"},on:{click:function(r){return e.handleEdit(t.row)}}},[e._v("编辑")])]}}])})],1),r("edit-dialog",{attrs:{"extra-info":{tkInfo:e.tkInfo,materialInfo:e.materialInfo}},on:{submit:e.getDetail},model:{value:e.dlgView,callback:function(t){e.dlgView=t},expression:"dlgView"}})],1)},i=[],o=(r("8e6e"),r("ac6a"),r("456d"),r("bd86")),a=r("cf43"),l=r("1790"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-drawer",{attrs:{"append-to-body":!0,"close-on-press-escape":!1,"wrapper-closable":!1,title:e.title,direction:"btt",size:"50%",visible:e.value,"destroy-on-close":!0,"before-close":e.beforeClose},on:{open:e.initSelect}},[r("el-row",{staticStyle:{"text-align":"right"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.visible=!0}}},[e._v("新增")])],1),r("el-row",[r("table-com",{ref:"baseTableRef",attrs:{loading:!1,selection:!1,"table-column-sort":!1,"table-data":e.tableData,"column-list":e.columnList,"operation-width":170,"table-height-type":270,"show-operate":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger"},on:{click:function(r){return e.handleDelete(t.row,t.index)}}},[e._v("删除")])]}}])})],1),r("div",{staticClass:"drawer-footer"},[r("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.handleConfirm}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))]),r("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1),r("barcode-list",{attrs:{"extra-info":{id:e.extraInfo.materialInfo.stockOutDetailId,forBusiness:"returnWarehouse",returnWarehouseNumber:e.extraInfo.tkInfo.billNumber,excludeIds:e.tableData.length?e.tableData.map((function(e){return e.stockOutDetailInventoryId})):[]}},on:{confirm:e.selectedBarcode},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}})],1)},c=[],u=r("8763"),d=r("f826");function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m={components:{BarcodeList:d["a"]},mixins:[u["a"],l["a"]],props:{value:{type:Boolean,default:!1},title:{type:String,default:"新增退库内容"},dialogType:{type:String,default:""},extraInfo:{type:Object,default:function(){return{}}}},data:function(){return{tableData:[],loading:!1,columnList:[{module:"word",prop:"currentPosition",label:"库位",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center",formatter:null},{module:"word",prop:"barcodeNumber",label:"条码号",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center",formatter:null},{module:"word",prop:"num",label:"数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center",formatter:null},{module:"word",prop:"unitName",label:"计量单位",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center",formatter:null}],visible:!1}},computed:{},methods:{initSelect:function(){this.getDetail()},selectedBarcode:function(e){e.length?this.tableData=e.map((function(e){return b({},e,{stockOutDetailInventoryId:e.id})})):this.tableData=[]},handleDelete:function(e,t){var r=this;this.$confirm("此操作将永久删除选中信息, 是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1}).then((function(){r.tableData.splice(t,1)})).catch((function(e){r.$notify.info({title:"消息",message:"已取消删除"})}))},handleConfirm:function(e){var t=this;this.tableData.length?(this.loading=!0,Object(a["j"])({detailList:this.tableData,returnWarehouseNumber:this.extraInfo.tkInfo.billNumber,returnWarehouseMaterialId:this.extraInfo.materialInfo.id,stockOutDetailId:this.extraInfo.materialInfo.stockOutDetailId}).then((function(e){var r=e.code;r||(t.$message({message:"".concat(t.title,"成功"),type:"success"}),t.$emit("submit"),t.beforeClose()),t.loading=!1})).catch((function(e){t.loading=!1}))):this.$message({message:"请选择退库内容",type:"warning"})},getDetail:function(e){var t=this;return new Promise((function(e,r){Object(a["g"])({returnWarehouseMaterialId:t.extraInfo.materialInfo.id}).then((function(r){var n=r.code,i=r.data;n||(t.tableData=i||[],e(r))})).catch((function(e){r(e)}))}))},beforeClose:function(e){this.$emit("input",!1),"function"===typeof e&&e()}}},p=m,h=(r("8a18"),r("2877")),g=Object(h["a"])(p,s,c,!1,null,"6112dc58",null),w=g.exports;function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v={components:{EditDialog:w},mixins:[l["a"]],props:{},data:function(){return{title:this.$route.meta.title,loading:!1,columnList:[{module:"word",prop:"materialGroupCode",label:"物料组",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center",formatter:null},{module:"word",prop:"materialCode",label:"物料编号",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center",formatter:null},{module:"word",prop:"materialName",label:"物料名称",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialAssessType_dictText",label:"评估类型",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"stockOutNum",label:"出库数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"returnNum",label:"退库数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}],form:{billNumber:"",date:"",stockOutNumber:"",inspect:null,detailList:[],status:""},rules:{stockOutNumber:[{required:!0,message:"请选择出库单号",trigger:"blur"}],date:[{required:!0,message:"请输入出库日期",trigger:"blur"}],inspect:[{required:!0,message:"请选择是否检验",trigger:"change"}]},tkInfo:{},materialInfo:{},dlgView:!1}},computed:{},mounted:function(){this.$route.params.billNumber&&this.getDetail()},methods:{handleEffect:function(){var e=this;return new Promise((function(t,r){Object(a["b"])({billNumber:e.$route.params.billNumber}).then((function(r){var n=r.code;n||e.getDetail().then((function(t){e.$notify.success({title:"成功",message:"生效成功"})})),t(r)})).catch((function(e){r(e)}))}))},handleFinish:function(){var e=this;return new Promise((function(t,r){Object(a["c"])({billNumber:e.$route.params.billNumber}).then((function(t){var r=t.code;r||(e.$store.dispatch("tagsView/delView",e.$route),e.$router.push({name:"OutBoundStockReturn"}),e.$message({message:"操作成功",type:"success"}))})).catch((function(e){}))}))},handleGoBack:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.push({name:"WmsOutBoundAddStockReturnInfo"})},getDetail:function(){var e=this,t={billNumber:this.$route.params.billNumber};return new Promise((function(r,n){Object(a["l"])(t).then((function(t){var n=t.code,i=t.data;if(!n){if(!i)return;e.tkInfo=y({},i),e.form.billNumber=e.tkInfo.billNumber,e.form.date=e.tkInfo.date,e.form.stockOutNumber=e.tkInfo.stockOutNumber,e.form.inspect=e.tkInfo.inspect,e.form.detailList=e.tkInfo.detailList,e.form.status=e.tkInfo.status}r(t)})).catch((function(e){n(e)}))}))},inspectChange:function(){var e=this;Object(a["h"])({id:this.tkInfo.id,inspect:this.form.inspect}).then((function(t){e.getDetail()})).catch((function(e){}))},handleEdit:function(e){this.materialInfo=e,this.dlgView=!0}}},k=v,x=Object(h["a"])(k,n,i,!1,null,"535048b6",null);t["default"]=x.exports}}]);
//# sourceMappingURL=WmsOutBoundStockReturnOrderInfo.91d3a77a.js.map