(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["OutBoundMaterialRequisitionSplit"],{"0efa":function(e,t,n){"use strict";var i=n("7ecf"),r=n.n(i);r.a},"181a4":function(e,t,n){"use strict";var i=n("18c8"),r=n.n(i);r.a},"18c8":function(e,t,n){},"32a6":function(e,t,n){var i=n("241e"),r=n("c3a1");n("ce7e")("keys",(function(){return function(e){return r(i(e))}}))},"464b":function(e,t,n){},"6d00":function(e,t,n){},"6fe3":function(e,t,n){"use strict";n.d(t,"q",(function(){return r})),n.d(t,"r",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"v",(function(){return d})),n.d(t,"t",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"l",(function(){return g})),n.d(t,"a",(function(){return y})),n.d(t,"w",(function(){return v})),n.d(t,"b",(function(){return w})),n.d(t,"p",(function(){return _})),n.d(t,"e",(function(){return O})),n.d(t,"x",(function(){return S})),n.d(t,"u",(function(){return x})),n.d(t,"s",(function(){return j})),n.d(t,"f",(function(){return C})),n.d(t,"j",(function(){return D}));var i=n("bc43");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/pageList",method:"post",data:e})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/listItem",method:"post",data:e})}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/add",method:"post",data:e})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/edit",method:"post",data:e})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/delete",method:"post",data:e})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionDetail/batchDelete",method:"post",data:e})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/detail",method:"post",data:e})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/print",method:"post",data:e})}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/oneKeySplit",method:"post",data:e})}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionDetail/pageList",method:"post",data:e})}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionDetail/pageList",method:"post",data:e})}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisition/detail",method:"post",data:e})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionDetail/delete",method:"post",data:e})}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionDetail/edit",method:"post",data:e})}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/add",method:"post",data:e})}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/basic/wmsMaterial/getListByCode",method:"post",data:e})}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionDetail/batchAdd",method:"post",data:e})}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/pageList",method:"post",data:e})}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/delete",method:"post",data:e})}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/submit",method:"post",data:e})}function x(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/print",method:"post",data:e})}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/listItem",method:"post",data:e})}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/edit",method:"post",data:e})}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/outWarehouse/wmsBillMaterialRequisitionSub/detail",method:"post",data:e})}},"72ba":function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"n",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"l",(function(){return g})),n.d(t,"m",(function(){return y}));var i=n("bc43"),r=n("ee8a");function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBook/pageList",method:"post",data:e,timeout:12e4})}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/basic/wmsMaterial/detail",method:"post",data:e})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBookDetail/pageList",method:"post",data:e})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBookHistory/pageList",method:"post",data:e})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBookDetail/listBarCode",method:"post",data:e})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBookDetail/split4StockOut",method:"post",data:e})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBookDetail/edit",method:"post",data:e})}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/warehouseMgt/wmsInventoryBook/groupExport",method:"post",data:e})}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBook/groupList",method:"post",data:e})}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBook/selectBillReservedByMaterialId",method:"post",data:e})}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBook/selectOrderByMaterialId",method:"post",data:e})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/warehouseMgt/wmsInventoryBook/export",method:"post",data:e})}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/warehouseMgt/wmsInventoryBookHistory/export",method:"post",data:e})}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/warehouseMgt/wmsInventoryBookDetail/queryInventoryNumByMaterialCode",method:"post",data:e})}},"7ecf":function(e,t,n){},8763:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("ac6a"),n("5df3");var i=n("cddf"),r={YesNo:"sys_yes_no",OfficeType:"sys_office_type",OfficeGrade:"sys_office_grade",SysDataScope:"sys_data_scope",SysRoleType:"sys_role_type",SysUserType:"sys_user_type",SysFileLevel:"sys_file_level",EmosMaterialUnitType:"emos_material_unit_type",EmosSbomChangeStatus:"emos_sbom_change_status",EmosObomInfoStatus:"emos_obom_info_status",EmosEquipmentKind:"emos_equipment_kind",EmosEquipmentGrade:"emos_equipment_grade",EmosStatisticsKind:"emos_statistics_kind",EmosAbcKind:"emos_abc_kind",EmosSpecialKind:"emos_special_kind",EmosEnableStatus:"emos_enable_status",EmosJobItemNamingRule:"emos_job_item_naming_rule",EmosJobWellType:"emos_job_well_type",EmosJobWellCategorye:"emos_job_well_category",EmosJobWellSize:"emos_job_well_size",EmosTechnologyStatus:"emos_technology_status",EmosEquipmentSource:"emos_equipment_source",EmosMaintainFactory:"emos_maintain_factory",EmosMainWorkCenter:"emos_main_work_center",EmosFunctionPlace:"emos_function_place",EmosIncomeStatus:"emos_income_status",EmosManufacturerUnit:"emos_manufacturer_unit",EmosCountry:"emos_country",EmosMaintainProcedureType:"emos_maintain_procedure_type",EmosMaintainProcedureFillway:"emos_maintain_procedure_fillway",EmosJobDemandStatus:"emos_job_demand_status",EmosJobRecordStatus:"emos_job_record_status",EmosJobType:"emos_job_type",EmosJobReturnInventoryStatus:"emos_job_return_inventory_status",FmnBulletinType:"fmn_bulletin_type",FmnBulletinStatus:"fmn_bulletin_status",EmosFmnOrderStatus:"emos_fmn_order_status",EmosMaintainLevel:"emos_maintain_level",EmosRepairType:"emos_repair_type",EmosEquipmentFaultedType:"emos_equipment_faulted_type",EmosBreakReasonLevel1:"emos_break_reason_level1",EmosBreakReasonLevel2:"emos_break_reason_level2",EmosFileSizeLimit:"emos_file_size_limit",EmosShuttleStatus:"emos_shuttle_status",EmosMaintainStrategyComparisonSymbol:"emos_maintain_strategy_comparison_symbol",EmosMaintainStrategyCalculationSymbol:"emos_maintain_strategy_calculation_symbol",EmosMaintainStrategyAndOr:"emos_maintain_strategy_and_or",EmosEquipmentFaultedStatus:"emos_equipment_faulted_status",EmosEquipmentFaultedSubStatus:"emos_equipment_faulted_sub_status",EmosEquipmentFaultedDetailStatus:"emos_equipment_faulted_detail_status",EmosBuckleType:"emos_buckle_type",EmosBuckleOutsourceStatus:"emos_buckle_outsource_status",EmosMaterialStockType:"emos_material_stock_type",EmosStaffPosition:"emos_staff_position",EmosStaffPositionClass:"emos_staff_position_class",EmosStaffEquipType:"emos_staff_equip_type",EmosStaffDemandAbility:"emos_staff_demand_ability",EmosAndonQuestionType:"emos_andon_question_type"},o={sys:"/sys/sysDict/find",mes:"/sys/mesDict/find",lms:"/sys/lmsDict/find",emos:"/sys/emosDict/find",wms:"/sys/wmsDict/find"},a={data:function(){return{sysDictCodeMixins:[],lmsDictCodeMixins:[],emosDictCodeMixins:[],wmsDictCodeMixins:[],dictCodeOptsMixins:{}}},mounted:function(){this.initDictCodeMixins()},methods:{initDictCodeMixins:function(){var e=this;Promise.all(this.sysDictCodeMixins.map((function(t){return e.getDictCodeMixins(t,"sys")}))).then((function(t){t.forEach((function(t){return e.$set(e.dictCodeOptsMixins,t.dictName,t.result)}))})),Promise.all(this.lmsDictCodeMixins.map((function(t){return e.getDictCodeMixins(t,"lms")}))).then((function(t){t.forEach((function(t){return e.$set(e.dictCodeOptsMixins,t.dictName,t.result)}))})),Promise.all(this.emosDictCodeMixins.map((function(t){return e.getDictCodeMixins(t,"emos")}))).then((function(t){t.forEach((function(t){return e.$set(e.dictCodeOptsMixins,t.dictName,t.result)}))})),Promise.all(this.wmsDictCodeMixins.map((function(t){return e.getDictCodeMixins(t,"wms")}))).then((function(t){t.forEach((function(t){return e.$set(e.dictCodeOptsMixins,t.dictName,t.result)}))}))},getDictCodeMixins:function(e,t){return new Promise((function(n,a){Object(i["j"])(o[t],{name:r[e]}).then((function(t){var i=t.code,r=t.data;i||n({dictName:e,result:r.dictDetails}),a(t)})).catch((function(e){a(e)}))}))}}}},"8aae":function(e,t,n){n("32a6"),e.exports=n("584a").Object.keys},"8ac4":function(e,t,n){},"9a2e":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));n("28a5");var i=n("cddf"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"inline-block"}},[e._t("pic"),n("el-upload",{ref:"upload",attrs:{sizi:"mini",action:""+e.BASE_API+e.url,headers:e.headers,accept:e.accept,"before-upload":e.beforeUpload,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:e.limit>1,limit:e.limit,"on-exceed":e.handleExceed,"file-list":e.fileList,"on-preview":e.handlePreview,"show-file-list":e.showFileList,"on-success":e.handleUploadSuccess,disabled:e.disabled,"on-progress":e.handleUploadProgress,"on-error":e.handleError}},[e.btnContent?n("el-button",{attrs:{type:"primary",size:"mini",icon:e.btnIcon,disabled:e.disabled}},[e._v("\n      "+e._s(e.btnContent)+"\n    ")]):n("el-button",{attrs:{type:"primary",size:"mini",icon:e.btnIcon,disabled:e.disabled}}),e._t("tip")],2)],2)},o=[],a=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("bd86")),l=n("a8db"),s=(n("c5f6"),n("4360"));function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"FormUploadFileComs",props:{uploadFileList:{type:Array,default:function(){return[]}},showFileList:{type:Boolean,default:!0},btnIcon:{type:String,default:""},btnContent:{type:String,default:"点击上传"},limit:{type:Number,default:1},url:{type:String,default:"/wms/file/upload"},accept:{type:String,default:""},limitSize:{type:Number,default:1e23},errDefaultMsg:{type:String,default:"文件上传失败"},disabled:{type:Boolean,default:!1}},data:function(){var e="".concat(s["a"].getters.token);return{fileList:[],BASE_API:"https://192.168.1.7:9005/api/wms",headers:{Authorization:e},uploadDisabled:!1,list:[]}},watch:{uploadFileList:{handler:function(e){this.fileList=e.map((function(e){var t=e.fileName,n=e.fileUrl,i=Object(l["a"])(e,["fileName","fileUrl"]);return c({},i,{url:n,name:t})}))},immediate:!0}},methods:{beforeUpload:function(e){var t=e.size<=1e3*this.limitSize;return t||this.$message({message:"上传大小不能超过 ".concat(this.limitSize,"k!"),type:"error"}),t&&this.$emit("openLoading"),t},handleUploadProgress:function(e,t,n){this.$emit("uploadFileProgress",e,t,n)},handleError:function(e,t,n){var i=this;setTimeout((function(){i.$notify.error({title:"错误",message:"上传失败"}),i.$emit("closeLoading")}),500)},handleUploadSuccess:function(e,t,n){if(this.$emit("closeLoading"),"导入成功"!==e){var i=e.code,r=e.data;if(i&&999===i)this.$notify.error({title:"错误",message:e.msg?e.msg:this.errDefaultMsg});else if(i)this.$refs.upload.clearFiles(),this.$emit("uploadFileError");else{if(!r.id)return void this.$emit("uploadFileSuccess");var o=r.id,a=r.fileUrl,l=r.fileType,s=r.downloadUrl,u=r.fileName,c=r.suffix,d={id:o,fileId:o,fileUrl:a,fileType:l,downloadUrl:s,suffix:c,fileName:u,name:u,url:a,classification:""};this.fileList.push(d),this.$emit("uploadFileSuccess",d)}}else this.$emit("uploadFileSuccess")},handleRemove:function(e,t){var n=Object.assign({},e);return n.id||0===n.id||(n.id=n.fileId),this.fileList=this.fileList.filter((function(e){return e.id!==n.id})),this.$emit("handleRemove",c({},n)),new Promise((function(e,t){Object(i["b"])({id:n.id}).then((function(n){var i=n.code;0===i?e():t()})).catch((function(e){t(e)}))}))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"),"提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",cancelButtonClass:"cancel-button-class",confirmButtonClass:"confirm-button-class",type:"warning",lockScroll:!1})},handlePreview:function(e){var t=e.id;window.open("".concat("https://192.168.1.7:9005/api/wms","/wms/file/download/").concat(t))},handleExceed:function(e,t){this.$notify({title:"警告",message:"当前限制上传附件数量是 ".concat(this.limit," 个文件"),type:"warning"})}}},m=d,f=n("2877"),p=Object(f["a"])(m,r,o,!1,null,"6cedfe06",null),b=p.exports,h={components:{FormUploadFile:b},data:function(){return{uploadTip:"",uploadFileList:[]}},methods:{uploadFileSuccess:function(e){this.uploadFileList.push(e)},handleRemove:function(e){var t=e.id;this.uploadFileList=this.uploadFileList.filter((function(e){return e.id!==t}))},initUploadFileList:function(e){var t=this;if(e&&"null"!==e)return new Promise((function(n,r){Object(i["g"])({ids:e}).then((function(e){var i=e.code,r=e.data;i||(t.uploadFileList=r),n(e)})).catch((function(e){r(e)}))}))},getFileIdList:function(){return this.uploadFileList.map((function(e){return e.id}))},resetFormUploadFilesMixins:function(){this.uploadFileList=[]},downloadUploadFileMixins:function(e){window.open("".concat(Object({NODE_ENV:"production",VUE_APP_BASE_API:"https://192.168.1.7:9005/api/system",VUE_APP_BASE_API_ACTIVITI:"https://192.168.1.7:9005/api/flowable",VUE_APP_BASE_API_WMS:"https://192.168.1.7:9005/api/wms",VUE_APP_BASE_PUBLIC_PATH:"/wms",BASE_URL:"/wms/"}).VUE_APP_BASE_API_LMS,"/wms/file/download/").concat(e))}}}},a4bb:function(e,t,n){e.exports=n("8aae")},a8db:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("e265"),r=n.n(i),o=n("a4bb"),a=n.n(o);function l(e,t){if(null==e)return{};var n,i,r={},o=a()(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}function s(e,t){if(null==e)return{};var n,i,o=l(e,t);if(r.a){var a=r()(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},cbbf:function(e,t,n){"use strict";var i=n("6d00"),r=n.n(i);r.a},ce7e:function(e,t,n){var i=n("63b6"),r=n("584a"),o=n("294c");e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],a={};a[e]=t(n),i(i.S+i.F*o((function(){n(1)})),"Object",a)}},d127:function(e,t,n){"use strict";var i=n("8ac4"),r=n.n(i);r.a},d8bb:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadLoading,expression:"uploadLoading"}],staticClass:"app-container",attrs:{"element-loading-text":"上传中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[n("el-tabs",{staticClass:"main-tab",attrs:{type:"card"},model:{value:e.viewType,callback:function(t){e.viewType=t},expression:"viewType"}},[n("el-tab-pane",{attrs:{label:"当前单据",name:"0"}},[n("current",{attrs:{"view-type":e.viewType},on:{changeUploadLoading:e.changeUploadLoading}})],1),n("el-tab-pane",{attrs:{label:"领料单子单",name:"1"}},[n("request",{attrs:{"view-type":e.viewType}})],1)],1)],1)},r=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"clearfix top-filter"},[n("el-form",{ref:"filterItem",attrs:{model:e.query,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{staticClass:"fl",attrs:{prop:"materialCodeOrName"}},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{placeholder:"物料编码或名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInit(t)}},model:{value:e.query.materialCodeOrName,callback:function(t){e.$set(e.query,"materialCodeOrName","string"===typeof t?t.trim():t)},expression:"query.materialCodeOrName"}})],1),n("el-form-item",{staticClass:"fl",attrs:{prop:"materialGroupCode"}},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{placeholder:"物料组编码或名称"},model:{value:e.query.materialGroupCode,callback:function(t){e.$set(e.query,"materialGroupCode","string"===typeof t?t.trim():t)},expression:"query.materialGroupCode"}})],1),n("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchInit}},[e._v("搜索")]),n("el-button",{staticClass:"filter-item",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("filterItem")}}},[e._v("重置")])],1)],1),n("el-row",[n("el-descriptions",{attrs:{column:3}},[n("el-descriptions-item",{attrs:{label:"日期"}},[e._v(e._s(e.baseInfo.date||"---"))]),n("el-descriptions-item",{attrs:{label:"交接单号"}},[e._v(e._s(e.baseInfo.billNumber||"---"))]),n("el-descriptions-item",{attrs:{label:"合同号/WBS号"}},[e._v(e._s(e.baseInfo.contractWbsNumber||"---"))])],1)],1),n("el-row",{staticStyle:{"text-align":"left"}},[n("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.addCurrentForm}},[e._v("新建当前单据")]),n("el-button",{staticClass:"filter-item",attrs:{type:"primary",disabled:!e.tableSelection.length},on:{click:e.addChildrenForm}},[e._v("新建子单")]),n("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-download"},on:{click:e.downloadTemplate}},[e._v("下载模板")]),n("form-upload-file",{ref:"uploadCom",staticStyle:{margin:"0 10px 0 10px"},attrs:{accept:".xls,.xlsx",url:"/outWarehouse/wmsBillMaterialRequisitionDetail/importExpModel/"+e.params.billNumber,"btn-content":"领料单导入","btn-icon":"el-icon-upload",limit:99999,"show-file-list":!1},on:{openLoading:e.handleOpenUploadLoading,closeLoading:e.handleCloseUploadLoading,uploadFileSuccess:e.handleUploadSuccess}}),n("el-button",{staticClass:"filter-item",attrs:{type:"danger",disabled:!e.tableSelection.length},on:{click:e.batchDelete}},[e._v("批量删除")])],1),n("el-row",[n("table-com",{ref:e.refName,class:{baseTable:e.tableData.length},attrs:{"row-key":e.rowKey,"table-height-type":530,selection:!0,"selection-fixed":!1,"table-selection":e.tableSelection,loading:e.loading,index:!0,"table-column-sort":!1,"table-data":e.tableData,"column-list":e.columnList,"operation-width":170,"show-operate":!0,"expand-list":e.expandList,"cell-style":e.handleCellStyle,"refresh-key":e.refreshKey,selectable:e.selectable},on:{rowClick:e.handleRowClick,refresh:e.searchInit,selectionChange:e.selectionChange,dynamicRow:e.getDynamicRow},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",disabled:t.row.splitNum>0},on:{click:function(n){return e.handleDeleteMaterial(t.row)}}},[e._v("删除")]),n("el-button",{attrs:{type:"primary",disabled:t.row.splitNum>=t.row.needNum},on:{click:function(n){return e.editMaterialForm(t.row)}}},[e._v("编辑")])]}}])})],1),n("pagination",{attrs:{page:e.pageInfo.current,limit:e.pageInfo.size,total:e.total},on:{"update:page":function(t){return e.$set(e.pageInfo,"current",t)},"update:limit":function(t){return e.$set(e.pageInfo,"size",t)},pagination:e.init}}),n("new-child-order-dialog",{attrs:{title:"新建子单","extra-info":{selectedList:e.tableSelection,billNumber:e.params.billNumber}},on:{submit:e.handleChildConfirm},model:{value:e.childVisible,callback:function(t){e.childVisible=t},expression:"childVisible"}}),n("new-current-order-dialog",{attrs:{"extra-info":{forBusiness:"billReserved",billNumber:e.params.billNumber}},on:{submit:e.init},model:{value:e.currentVisible,callback:function(t){e.currentVisible=t},expression:"currentVisible"}}),n("edit-material-info",{attrs:{"dialog-form":e.dialogForm},on:{submit:e.init},model:{value:e.editVisible,callback:function(t){e.editVisible=t},expression:"editVisible"}})],1)},a=[],l=(n("8e6e"),n("456d"),n("75fc")),s=n("a8db"),u=n("bd86"),c=(n("ac6a"),n("6fe3")),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{width:"1000px",title:e.title,visible:e.value,"lock-scroll":!1,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.beforeClose},on:{open:e.initSelect}},[n("el-row",[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"需求日期：",prop:"needDate"}},[n("el-date-picker",{staticStyle:{width:"178px"},attrs:{align:"center",type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择"},model:{value:e.form.needDate,callback:function(t){e.$set(e.form,"needDate",t)},expression:"form.needDate"}})],1),n("el-row",[n("table-com",{ref:"baseTableRef",attrs:{loading:!1,"table-height-type":490,selection:!1,"row-key":"id","table-column-sort":!1,"table-data":e.form.detailList,"column-list":e.columnList,"operation-width":120,"show-operate":!0,"refresh-key":e.refreshKey},on:{rowClick:e.handleRowClick},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",circle:"",icon:"el-icon-minus"},on:{click:function(n){return e.handleDelete(t.index)}}})]}}])})],1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleConfirm("form")}}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))]),n("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1)},m=[],f=(n("7514"),n("2ef0")),p=n.n(f),b=n("1790");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(){return{needDate:"",detailList:[]}},v={components:{},mixins:[b["a"]],props:{value:{type:Boolean,default:!1},title:{type:String,default:""},extraInfo:{type:Object,default:function(){}}},data:function(){return{loading:!1,rules:{needDate:[{required:!0,message:"请选择需求日期",trigger:"change"}]},columnList:[{module:"word",prop:"warehouseSapName",label:"SAP仓库",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialCode",label:"物料编码",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialName",label:"物料名称",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialAssessType_dictText",label:"评估类型",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"unitName",label:"计量单位",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"inventoryNum",label:"库存数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"number",prop:"needNum",label:"需求数量",align:"center",minWidth:160,fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center",setMin:function(e){return 0},setPrecision:function(e){return 3},handleChange:p.a.throttle((function(e){}),1e3),showOverflowTooltip:!1,setMax:function(e){return e.needMaxNum}},{module:"word",prop:"needDate",label:"需求日期",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialGroupCode",label:"物料组",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialGroupDesc",label:"物料组描述",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}],refreshKey:1,form:y()}},dicts:[],watch:{},methods:{initSelect:function(){this.form.needDate=this.getCurrentDate(),this.form.detailList=this.extraInfo.selectedList.map((function(e){var t=e.needNum-e.splitNum;return g({},e,{needNum:t>e.inventoryNum?e.inventoryNum:t,needMaxNum:t>e.inventoryNum?e.inventoryNum:t})}))},getCurrentDate:function(){var e=new Date,t={y:e.getFullYear(),m:e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,d:e.getDate()<10?"0".concat(e.getDate()):e.getDate()};return"".concat(t.y,"-").concat(t.m,"-").concat(t.d)},handleRowClick:function(e){e.row;var t=e.column;e.cell,e.event;if("操作"===t.label)return!1},handleDelete:function(e){this.form.detailList.splice(e,1)},handleConfirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var n=t.form.detailList.find((function(e){return e.needNum<=0}));n?t.$message({message:"物料["+n.materialCode+"]需求数量须大于0",type:"error"}):(t.loading=!0,Object(c["a"])(g({},t.form,{requisitionNumber:t.extraInfo.billNumber})).then((function(e){var n=e.code;n||(t.$message({message:"".concat(t.title,"成功"),type:"success"}),t.$emit("submit"),t.beforeClose()),t.loading=!1})).catch((function(e){t.loading=!1})))}))},beforeClose:function(e){this.form=y(),this.$emit("input",!1),"function"===typeof e&&e()}}},w=v,_=(n("181a4"),n("2877")),O=Object(_["a"])(w,d,m,!1,null,"7c8f63e0",null),S=O.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-drawer",{attrs:{center:!0,"append-to-body":!0,"close-on-press-escape":!1,"wrapper-closable":!1,title:e.title,size:"50%",visible:e.value,"destroy-on-close":!0,"before-close":e.beforeClose},on:{open:e.initSelect}},[n("el-form",{ref:"filterItem",staticClass:"top-filter clearfix",attrs:{model:e.form,inline:"",rules:e.rules,"label-width":"100px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{prop:"materialCode"}},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{placeholder:"物料编码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch(t)}},model:{value:e.form.materialCode,callback:function(t){e.$set(e.form,"materialCode","string"===typeof t?t.trim():t)},expression:"form.materialCode"}})],1),n("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),n("el-button",{staticClass:"filter-item",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("filterItem")}}},[e._v("重置")])],1),n("el-row",[n("table-com",{ref:e.refName,attrs:{"ref-name":e.tableRef,loading:e.loading,"table-height-type":725,selection:!1,"row-key":e.rowKey,"highlight-current-row":"","cell-style":e.handleCellStyle,"table-column-sort":!1,"table-data":e.tableData,"column-list":e.columnList,"operation-width":120,"show-operate":!0,"refresh-key":e.refreshKey},on:{rowClick:e.handleRowClick,refresh:e.handleRefresh},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row,t.index)}}},[e._v("删除")])]}}])})],1),n("div",{staticClass:"drawer-footer"},[n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.handleConfirm("form")}}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))]),n("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1)},j=[],C=(n("20d6"),n("7f7f"),n("ed08"));function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(){return{materialCode:""}},P={components:{},mixins:[b["a"]],props:{value:{type:Boolean,default:!1},title:{type:String,default:"新建当前单据"},extraInfo:{type:Object,default:function(){return{}}}},data:function(){return{form:k(),currentDate:"",loading:!1,rowKey:"id1",refName:"baseTableRef",tableRef:"tableRef",refreshKey:1,rules:{},tableData:[],columnList:[{module:"word",prop:"warehouseSapName",label:"SAP仓库",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialCode",label:"物料编码",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialName",label:"物料名称",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"assessType_dictText",label:"评估类型",align:"center",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"inventoryNum",label:"库存数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"number",prop:"needNum",label:"需求数量",align:"center",minWidth:160,fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center",isShow:function(e){return!0},getDisplay:function(e){return""},disabled:function(e){return!1},setMin:function(e){return 0},setMax:function(e){return 1/0},setPrecision:function(e){return 3},handleChange:p.a.throttle((function(e){}),1e3),showOverflowTooltip:!1},{module:"date",prop:"needDate",label:"需求日期",align:"center",width:"",minWidth:160,fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center",inputWidth:"130",valueFormat:"yyyy-MM-dd",placeholder:"请选择日期",clearable:!0,isShow:function(e){return!0},getDisplay:function(e){return""},setDisabled:function(e){return!1},handleChange:function(e){return null},showOverflowTooltip:!1}]}},computed:{},watch:{},methods:{initSelect:function(){var e=new Date,t={y:e.getFullYear(),m:e.getMonth()+1<10?"0".concat(e.getMonth()+1):e.getMonth()+1,d:e.getDate()<10?"0".concat(e.getDate()):e.getDate()};this.currentDate="".concat(t.y,"-").concat(t.m,"-").concat(t.d)},handleSearch:Object(C["a"])((function(){var e=this;if(this.form.materialCode){var t=this.tableData.some((function(t){return t.materialCode===e.form.materialCode}));if(!t)return new Promise((function(t,n){var i=N({},e.form);Object(c["w"])(i).then((function(n){var i=n.code,r=n.data;if(!i&&Array.isArray(r)&&r.length){var o=r.map((function(t){return N({},t,{materialId:t.id,materialCode:t.code,materialName:t.name,assessType_dictText:t.assessType_dictText,inventoryNum:t.inventoryNum,needNum:0,needDate:e.currentDate,requisitionNumber:e.extraInfo.billNumber})}));e.tableData=[].concat(Object(l["a"])(e.tableData),Object(l["a"])(o)),e.tableData.forEach((function(e,t){e.id1="".concat(e.id,"-").concat(t)})),e.scrollToRow(o[0])}t(n)})).catch((function(e){n(e)}))}));this.$notify.warning({title:"警告",message:"当前物料已添加，请勿重复操作！"})}}),800,!1),resetForm:function(e){this.$refs[e].resetFields(),this.form=k()},handleRefresh:function(){},handleCellStyle:function(e){var t=e.row,n={backgroundColor:t.materialCode===this.form.materialCode?"#409EFF":""};return n},scrollToRow:function(e){var t=this;this.$nextTick((function(){var n=t.$refs[t.refName].$refs[t.tableRef];if(n){var i=n.$el.querySelectorAll(".el-table__body tr"),r=i[t.tableData.findIndex((function(n){return n[t.rowKey]===e[t.rowKey]}))];r&&r.scrollIntoView(!0)}}))},handleDelete:function(e,t){var n=this;this.$confirm("此操作将永久删除该物料, 是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",cancelButtonClass:"btn-custom-cancel",type:"warning",lockScroll:!1}).then((function(){n.tableData.splice(t,1),n.tableData[t]&&n.scrollToRow(n.tableData[t]),n.$notify.success({title:"成功",message:"删除成功"})})).catch((function(){n.$notify.info({title:"信息",message:"取消删除"})}))},handleRowClick:function(){},handleConfirm:function(){var e=this,t=this.tableData.some((function(e){return!e.needDate||!e.needNum}));if(!t)return new Promise((function(t,n){Object(c["b"])(Object(l["a"])(e.tableData)).then((function(n){var i=n.code;i||(e.$notify.success({title:"成功",message:"单据新增成功"}),e.$emit("submit"),e.beforeClose()),t(n)})).catch((function(e){n(e)}))}));this.$notify.warning({title:"警告",message:"当前列表存在需求日期或需求数量未填项，请检查并填写！"})},beforeClose:function(e){this.resetForm("filterItem"),this.tableData=[],this.$emit("input",!1),"function"===typeof e&&e()}}},E=P,M=(n("dbef"),Object(_["a"])(E,x,j,!1,null,"8af4d6ac",null)),$=M.exports,T=n("8763"),B=n("9a2e"),I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-drawer",{attrs:{center:!0,"append-to-body":!0,"close-on-press-escape":!1,"wrapper-closable":!1,title:e.title,size:"50",visible:e.value,"destroy-on-close":!0,"before-close":e.beforeClose},on:{open:e.initSelect}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[n("el-scrollbar",{staticClass:"scroll-drawer"},[n("el-form-item",{attrs:{label:"SAP仓库",prop:"warehouseId"}},[n("el-select",{staticStyle:{width:"178px"},attrs:{placeholder:"请选择"},on:{change:e.handleSelectChange},model:{value:e.form.warehouseId,callback:function(t){e.$set(e.form,"warehouseId",t)},expression:"form.warehouseId"}},e._l(e.warehousePullList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.warehouseSapName,value:e.warehouseSapId}})})),1)],1),n("el-form-item",{attrs:{label:"物料编码",prop:"materialCode"}},[n("el-input",{staticStyle:{width:"178px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.materialCode,callback:function(t){e.$set(e.form,"materialCode","string"===typeof t?t.trim():t)},expression:"form.materialCode"}})],1),n("el-form-item",{attrs:{label:"物料名称",prop:"materialName"}},[n("el-input",{staticStyle:{width:"465px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.materialName,callback:function(t){e.$set(e.form,"materialName","string"===typeof t?t.trim():t)},expression:"form.materialName"}})],1),n("el-form-item",{attrs:{label:"评估类型",prop:"materialAssessType_dictText"}},[n("el-input",{staticStyle:{width:"178px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.materialAssessType_dictText,callback:function(t){e.$set(e.form,"materialAssessType_dictText","string"===typeof t?t.trim():t)},expression:"form.materialAssessType_dictText"}})],1),n("el-form-item",{attrs:{label:"计量单位",prop:"unitName"}},[n("el-input",{staticStyle:{width:"178px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.unitName,callback:function(t){e.$set(e.form,"unitName","string"===typeof t?t.trim():t)},expression:"form.unitName"}})],1),n("el-form-item",{attrs:{label:"库存数量",prop:"inventoryNum"}},[n("el-input",{staticStyle:{width:"178px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.inventoryNum,callback:function(t){e.$set(e.form,"inventoryNum","string"===typeof t?t.trim():t)},expression:"form.inventoryNum"}})],1),n("el-form-item",{attrs:{label:"需求数量",prop:"needNum"}},[n("el-input-number",{staticStyle:{width:"178px"},attrs:{min:.001,max:1/0,precision:3,placeholder:"请输入"},model:{value:e.form.needNum,callback:function(t){e.$set(e.form,"needNum","string"===typeof t?t.trim():t)},expression:"form.needNum"}})],1),n("el-form-item",{attrs:{label:"需求日期",prop:"needDate"}},[n("el-date-picker",{staticStyle:{width:"178px"},attrs:{type:"date","value-format":"yyyy-MM-dd",disabled:!0,placeholder:"请选择"},model:{value:e.form.needDate,callback:function(t){e.$set(e.form,"needDate",t)},expression:"form.needDate"}})],1),n("el-form-item",{attrs:{label:"物料组",prop:"materialGroupCode"}},[n("el-input",{staticStyle:{width:"178px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.materialGroupCode,callback:function(t){e.$set(e.form,"materialGroupCode","string"===typeof t?t.trim():t)},expression:"form.materialGroupCode"}})],1),n("el-form-item",{attrs:{label:"物料组描述",prop:"materialGroupDesc"}},[n("el-input",{staticStyle:{width:"465px"},attrs:{disabled:!0,placeholder:"请输入"},model:{value:e.form.materialGroupDesc,callback:function(t){e.$set(e.form,"materialGroupDesc","string"===typeof t?t.trim():t)},expression:"form.materialGroupDesc"}})],1)],1),n("div",{staticClass:"drawer-footer"},[n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.handleConfirm("form")}}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))]),n("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1)],1)},L=[],q=n("72ba");function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(){return{warehouseId:"",materialCode:"",materialName:"",materialAssessType_dictText:"",unitName:"",inventoryNum:"",needNum:"",needDate:"",materialGroupCode:"",materialGroupDesc:""}},W={props:{value:{type:Boolean,default:!1},title:{type:String,default:"编辑物料信息"},billNumber:{type:String,default:""},extraInfo:{type:Object,default:function(){return{}}},dialogForm:{type:Object,default:function(){return R({},F())}}},data:function(){return{form:F(),loading:!1,selectInfo:{list:[],visible:!1,radio:""},rules:{needNum:[{required:!0,message:"请输入需求数量",trigger:"blur"}]},warehousePullList:[]}},computed:{},watch:{dialogForm:{handler:function(e){this.form=R({},e)},immediate:!0}},methods:{handleConfirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,Object(c["l"])(R({},t.form)).then((function(e){var n=e.code;n||(t.$message({message:"".concat(t.title,"成功"),type:"success"}),t.$emit("submit"),t.beforeClose()),t.loading=!1})).catch((function(e){t.loading=!1}))}))},initSelect:function(){this.getWarehousePullList()},getWarehousePullList:function(){var e=this;return new Promise((function(t,n){Object(q["m"])({materialCode:e.form.materialCode}).then((function(n){var i=n.code,r=n.data;i||(e.warehousePullList=r||[]),t(n)})).catch((function(e){n(e)}))}))},handleSelectChange:function(e){var t=this.warehousePullList.find((function(t){return t.warehouseSapId===e}));this.form.inventoryNum=t?t.inventoryNum:0},beforeClose:function(e){this.$refs.form.resetFields(),this.$emit("input",!1),this.form=Object.assign({},R({},F())),"function"===typeof e&&e()}}},z=W,U=(n("cbbf"),Object(_["a"])(z,I,L,!1,null,"14aafef3",null)),V=U.exports;function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={components:{NewChildOrderDialog:S,NewCurrentOrderDialog:$,EditMaterialInfo:V},mixins:[b["a"],T["a"],B["a"]],props:{viewType:{type:String,default:""}},data:function(){return{query:{materialCodeOrName:"",materialGroupCode:""},currentVisible:!1,editVisible:!1,dialogForm:{},tableSelection:[],params:"",loading:!1,baseInfo:{},childVisible:!1,refName:"baseTableRef",expandList:[],refreshKey:0,tableData:[],columnList:[{module:"word",prop:"warehouseSapName",label:"SAP仓库",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialCode",label:"物料编码",align:"center",minWidth:"",fixed:!1,sortable:!0,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialName",label:"物料名称",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialAssessType_dictText",label:"评估类型",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"unitName",label:"计量单位",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"inventoryNum",label:"库存数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"needNum",label:"需求数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"needDate",label:"需求日期",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialGroupCode",label:"物料组",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialGroupDesc",label:"物料组描述",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}],rowKey:"id"}},watch:{tableSelection:{handler:function(e){var t=this;e.length<=1||e.forEach((function(e){var n=t.tableSelection[0].warehouseSapName,i=e.needNum-e.splitNum!==0&&e.warehouseSapName===n;i||t.$nextTick((function(){t.$refs[t.refName].$refs.multipleTable.toggleRowSelection(e,!1)}))}))},deep:!0},viewType:{handler:function(e){"0"===e&&(this.init(),this.getDetail())}}},mounted:function(){this.params=this.$route.params,this.init(),this.getDetail()},methods:{init:function(){var e=this,t=K({},this.query,{requisitionNumber:this.params.billNumber||"",page:K({},this.pageInfo)});return this.loading=!0,new Promise((function(n,i){Object(c["o"])(K({},t)).then((function(t){var i=t.code,r=t.data;if(!i){var o=r.list,a=Object(s["a"])(r,["list"]);e.initPage(a),e.tableData=o;var l=e.rowKey,u=e.tableSelection.map((function(e){return e[l]}));e.tableData.forEach((function(t){function n(e){var t=e[l];return u.some((function(e){return e===t}))}n(t)&&e.$nextTick((function(){e.$refs[e.refName].$refs.multipleTable.toggleRowSelection(t,!0)}))}))}e.loading=!1,n(t)})).catch((function(t){e.loading=!1,i(t)}))}))},getDetail:function(){var e=this;return new Promise((function(t,n){Object(c["i"])({billNumber:e.params.billNumber||""}).then((function(n){var i=n.code,r=n.data;i||(e.baseInfo=r),t(n)})).catch((function(e){n(e)}))}))},addChildrenForm:function(){this.childVisible=!0},batchDelete:function(){var e=this;this.$confirm("此操作将批量删除选中信息, 是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1}).then((function(){var t={ids:e.tableSelection.map((function(e){return e.id}))};Object(c["c"])(K({},t)).then((function(t){var n=t.code;n||(e.$notify.success({title:"成功",message:"删除成功"}),e.$nextTick((function(){e.tableSelection.forEach((function(t){e.$refs[e.refName].$refs.multipleTable.toggleRowSelection(t,!1)}))})),e.init())})).catch((function(e){}))})).catch((function(t){e.$notify.info({title:"消息",message:"已取消删除"})}))},handleChildConfirm:function(){this.resetSelect(),this.init()},addCurrentForm:function(){this.currentVisible=!0},editMaterialForm:function(e){this.editVisible=!0,this.dialogForm=K({},e)},resetForm:function(e){this.$refs[e].resetFields(),this.searchInit()},resetSelect:function(){this.tableSelection=new Array(0)},selectable:function(e,t){if(this.tableSelection.length){var n=this.tableSelection[0].warehouseSapName;return e.needNum-e.splitNum>0&&e.warehouseSapName===n}return e.needNum-e.splitNum>0},handleOpenUploadLoading:function(){this.$emit("changeUploadLoading",!0)},handleCloseUploadLoading:function(){this.$emit("changeUploadLoading",!1)},handleUploadSuccess:function(){this.init(),this.$notify.success({title:"成功",message:"上传成功"})},handleCellStyle:function(e){e.row;var t={};return t},handleRowClick:function(e){e.row;var t=e.column;e.cell,e.event;if("操作"===t.label)return!1},selectionChange:function(e){this.tableSelection=Object(l["a"])(e)},getDynamicRow:function(e){},downloadTemplate:function(){window.open("".concat("https://192.168.1.7:9005/api/wms","/outWarehouse/wmsBillMaterialRequisitionDetail/downloadImportTemplate"))},handleDeleteMaterial:function(e){var t=this;this.$confirm("此操作将永久删除选中信息, 是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1}).then((function(){var n={id:e.id};Object(c["d"])(K({},n)).then((function(n){var i=n.code;i||(t.$notify.success({title:"成功",message:"删除成功"}),t.$nextTick((function(){t.$refs[t.refName].$refs.multipleTable.toggleRowSelection(e,!1)})),t.init())})).catch((function(e){}))})).catch((function(e){t.$notify.info({title:"消息",message:"已取消删除"})}))}}},H=J,Y=(n("d127"),Object(_["a"])(H,o,a,!1,null,"2889118e",null)),Q=Y.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"clearfix top-filter"},[n("el-form",{ref:"filterItem",attrs:{model:e.query,inline:""}},[n("el-form-item",{staticClass:"fl",attrs:{prop:"subNumber"}},[n("el-select",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{filterable:"",clearable:"",placeholder:"子单号"},model:{value:e.query.subNumber,callback:function(t){e.$set(e.query,"subNumber",t)},expression:"query.subNumber"}},e._l(e.SonPullList,(function(e,t){return n("el-option",{key:t,attrs:{label:e.subNumber,value:e.subNumber}})})),1)],1),n("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchInit}},[e._v("搜索")])],1)],1),n("el-row",[n("table-com",{ref:"baseTableRef",attrs:{loading:e.loading,index:!0,selection:!1,"table-data":e.tableData,"column-list":e.columnList,"operation-width":350,"table-column-sort":!1,"show-operate":!0},on:{refresh:e.searchInit},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.status?[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.handle(t.row,"Submit")}}},[e._v("提交")]),n("el-button",{attrs:{type:"warning"},on:{click:function(n){return e.handleModify(t.row)}}},[e._v("修改")]),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return e.handle(t.row,"Delete")}}},[e._v("删除")])]:e._e(),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.handleDetail(t.row)}}},[e._v("详情")]),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.handlePrint(t.row)}}},[e._v("打印")])]}}])})],1),n("pagination",{attrs:{page:e.pageInfo.current,limit:e.pageInfo.size,total:e.total},on:{"update:page":function(t){return e.$set(e.pageInfo,"current",t)},"update:limit":function(t){return e.$set(e.pageInfo,"size",t)},pagination:e.init}})],1)},Z=[];n("6762"),n("2fdb"),n("a481");function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){Object(u["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne={components:{},mixins:[b["a"],T["a"]],props:{viewType:{type:String,default:""}},data:function(){return{query:{subNumber:""},params:{},loading:!1,tableData:[],SonPullList:[],dialogType:"",columnList:[{module:"word",prop:"subNumber",label:"子单号",align:"center",width:"",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"createUserName",label:"创建人",align:"center",minWidth:"",width:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"createDate",label:"创建时间",align:"center",minWidth:"",width:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"printTimes",label:"打印次数",align:"center",minWidth:"",width:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}]}},computed:{pageType:function(){return this.$route.name.replace("OutBoundReservationForm","").toLowerCase()}},watch:{viewType:{handler:function(e){"1"===e&&(this.init(),this.getSonPull())}}},mounted:function(){this.params=this.$route.params,this.init(),this.getSonPull()},methods:{init:function(){var e=this;return new Promise((function(t,n){var i=e.query;e.loading=!0,Object(c["p"])(te({},i,{requisitionNumber:e.params.billNumber,page:te({},e.pageInfo)})).then((function(n){var i=n.code,r=n.data;if(!i){var o=r.list,a=Object(s["a"])(r,["list"]);e.initPage(a),e.tableData=o}e.loading=!1,t(n)})).catch((function(t){e.loading=!1,n(t)}))}))},handlePrint:function(e){var t=e.requisitionNumber,n=e.subNumber,i={requisitionNumber:t,subNumber:n};return new Promise((function(e,t){Object(c["u"])(te({},i)).then((function(t){var n=t.code,i=t.data;n||window.open("https://192.168.1.7:9005/api/wms"+i),e(t)})).catch((function(e){t(e)}))}))},getSonPull:function(){var e=this;return new Promise((function(t,n){Object(c["s"])({requisitionNumber:e.params.billNumber}).then((function(n){var i=n.code,r=n.data;i||(e.SonPullList=r||[]),t(n)})).catch((function(e){n(e)}))}))},handleModify:function(e){this.$router.push({name:"OutBoundMaterialRequisitionSubOrderEdit",query:{billNumber:e.subNumber}})},handle:function(e,t){var n=this,i={Submit:{api:c["x"],tip:"该工单即将提交"},Delete:{api:c["e"],tip:"该工单即将删除"}};this.$confirm("".concat(i[t]["tip"],"，是否继续？"),"提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",cancelButtonClass:"btn-custom-cancel",type:"warning",lockScroll:!1}).then((function(){i[t]["api"](te({},"Delete"===t&&{id:e.id},{},["Submit"].includes(t)&&{subNumber:e.subNumber},{},["Withdraw"].includes(t)&&{billNumber:e.subNumber})).then((function(e){var t=e.code;t||(n.$notify.success({title:"成功",message:"操作成功"}),n.init())}))})).catch((function(e){n.$notify.info({title:"消息",message:"操作已取消"})}))},handleDetail:function(e){this.$router.push({name:"OutBoundMaterialRequisitionSubOrderDetail",query:{billNumber:e.subNumber}})},resetForm:function(e){this.$refs[e].resetFields(),this.searchInit()}}},ie=ne,re=Object(_["a"])(ie,X,Z,!1,null,"50088653",null),oe=re.exports,ae={name:"OutBoundMaterialRequisitionSplit",components:{Current:Q,Request:oe},props:{},data:function(){return{viewType:"0",uploadLoading:!1}},mounted:function(){},methods:{changeUploadLoading:function(e){this.uploadLoading=e}}},le=ae,se=(n("0efa"),Object(_["a"])(le,i,r,!1,null,"2700f610",null));t["default"]=se.exports},dbef:function(e,t,n){"use strict";var i=n("464b"),r=n.n(i);r.a},e265:function(e,t,n){e.exports=n("ed33")},ed33:function(e,t,n){n("014b"),e.exports=n("584a").Object.getOwnPropertySymbols},ee8a:function(e,t,n){"use strict";n("6b54");var i=n("bc3a"),r=n.n(i),o=n("5c96"),a=n("4360"),l=n("5f87"),s={baseURL:"https://192.168.1.7:9005/api/wms",withCredentials:!0,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json"}},u=r.a.create(s),c=!1;u.interceptors.request.use((function(e){return a["a"].getters.token&&(e["responseType"]="blob",e.headers["Authorization"]="".concat(a["a"].getters.token)),e}),(function(e){Promise.reject(e)})),u.interceptors.response.use((function(e){return e&&e.data&&e.data.code&&999===e.data.code&&o["Notification"].error({message:e.data.msg,duration:5e3}),e}),(function(e){var t=0;try{t=e.response.status}catch(n){if(-1!==e.toString().indexOf("Error: timeout"))return o["Notification"].error({title:"网络请求超时",duration:5e3}),Promise.reject(e)}return 401===t||403===t?(c||(c=!0,o["Notification"].error({title:"登录信息已过期或者没有访问权限",duration:5e3}),setTimeout((function(){c=!1}),5e3)),a["a"].dispatch("resetToken").then((function(){setTimeout((function(){window.location.href=Object(l["b"])()}),3e3)})),Promise.reject(e)):(o["Notification"].error({title:e,duration:5e3}),Promise.reject(e))})),t["a"]=u}}]);
//# sourceMappingURL=OutBoundMaterialRequisitionSplit.ee2cbf33.js.map