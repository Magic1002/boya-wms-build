(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AnalysisMaterialPrice"],{"32a6":function(t,e,a){var i=a("241e"),r=a("c3a1");a("ce7e")("keys",(function(){return function(t){return r(i(t))}}))},"8aae":function(t,e,a){a("32a6"),t.exports=a("584a").Object.keys},9912:function(t,e,a){"use strict";var i=a("a9d7"),r=a.n(i);r.a},a4bb:function(t,e,a){t.exports=a("8aae")},a8db:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var i=a("e265"),r=a.n(i),n=a("a4bb"),l=a.n(n);function o(t,e){if(null==t)return{};var a,i,r={},n=l()(t);for(i=0;i<n.length;i++)a=n[i],e.indexOf(a)>=0||(r[a]=t[a]);return r}function s(t,e){if(null==t)return{};var a,i,n=o(t,e);if(r.a){var l=r()(t);for(i=0;i<l.length;i++)a=l[i],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}},a9d7:function(t,e,a){},ce7e:function(t,e,a){var i=a("63b6"),r=a("584a"),n=a("294c");t.exports=function(t,e){var a=(r.Object||{})[t]||Object[t],l={};l[t]=e(a),i(i.S+i.F*n((function(){a(1)})),"Object",l)}},e265:function(t,e,a){t.exports=a("ed33")},ed33:function(t,e,a){a("014b"),t.exports=a("584a").Object.getOwnPropertySymbols},f0bc:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"clearfix top-filter"},[a("el-form",{ref:"filterItem",attrs:{model:t.query,inline:""},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{staticClass:"fl",attrs:{prop:"materialCode"}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{clearable:"",placeholder:"物料编号"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchInit(e)}},model:{value:t.query.materialCode,callback:function(e){t.$set(t.query,"materialCode","string"===typeof e?e.trim():e)},expression:"query.materialCode"}})],1),a("el-form-item",{staticClass:"fl",attrs:{prop:"startDate"}},[a("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"开始时间",clearable:"",editable:!1},model:{value:t.query.startDate,callback:function(e){t.$set(t.query,"startDate",e)},expression:"query.startDate"}})],1),a("el-form-item",{staticClass:"fl",attrs:{prop:"endDate"}},[a("el-date-picker",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"结束时间",clearable:"",editable:!1},model:{value:t.query.endDate,callback:function(e){t.$set(t.query,"endDate",e)},expression:"query.endDate"}})],1)],1),a("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-search"},on:{click:t.handleSearch}},[t._v("搜索")]),a("el-button",{staticClass:"filter-item",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:function(e){return t.resetForm("filterItem")}}},[t._v("重置")])],1),a("el-row",[a("el-button",{staticClass:"filter-item",attrs:{type:"info",icon:"el-icon-setting"},on:{click:t.setTable}},[t._v("设置")]),a("el-button",{staticClass:"filter-item",attrs:{type:"info",icon:"el-icon-setting",loading:t.dialogLoading},on:{click:t.openDialog}},[t._v("自定义统计")]),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.handleExport}},[t._v("导出")])],1),t.query.materialCode&&t.chartList.length?a("el-collapse",{staticStyle:{margin:"0 0 20px 0"},attrs:{accordion:""},on:{change:function(e){t.baseTableKey++}},model:{value:t.collapseValue,callback:function(e){t.collapseValue=e},expression:"collapseValue"}},[a("el-collapse-item",{attrs:{title:"图表展示",name:"1"}},[t.collapseValue?a("chart-com",{ref:"chartCom",staticStyle:{height:"310px"},attrs:{data:t.chartList}}):t._e()],1)],1):t._e(),a("el-row",[a("table-com",{key:t.baseTableKey,ref:t.refTableName,attrs:{"ref-name":t.refName,"table-height-type":t.query.materialCode&&t.chartList.length&&t.collapseValue?220:630,loading:t.loading,index:!0,selection:!1,"table-column-sort":!0,"form-ident":t.formIdent,"table-data":t.tableData,"column-list":t.columnList,"show-operate":!1,"refresh-key":t.refreshKey,"expand-list":t.expandList},on:{rowClick:t.handleRowClick,refresh:t.searchInit}})],1),a("pagination",{attrs:{page:t.pageInfo.current,limit:t.pageInfo.size,total:t.total,"page-sizes":[50,100,150,500]},on:{"update:page":function(e){return t.$set(t.pageInfo,"current",e)},"update:limit":function(e){return t.$set(t.pageInfo,"size",e)},pagination:t.init}}),a("edit-dialog",{attrs:{"form-ident":t.formIdent,"table-data":t.dialogTableData,"column-list":t.columnListInput,"expand-list":t.expandList},on:{"update:tableData":function(e){t.dialogTableData=e},"update:table-data":function(e){t.dialogTableData=e},dialogConfirm:t.onDialogConfirm,handleSubmitCustomData:t.handleSubmitCustomData},model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}})],1)},r=[],n=(a("8e6e"),a("456d"),a("96cf"),a("3b8d")),l=(a("a481"),a("ac6a"),a("8615"),a("a8db")),o=a("bd86"),s=a("e08f"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return Array.isArray(t.data)?a("el-row",{staticStyle:{height:"100%","overflow-y":"auto"},attrs:{gutter:20}},t._l(t.data,(function(t,e){return a("el-col",{key:e,staticStyle:{height:"100%"},attrs:{span:12}},[a("chart",{staticStyle:{height:"100%"},attrs:{"chart-data":t,"ref-name":"Chart"+e,title:t.materialName}})],1)})),1):t._e()},u=[],f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:t.refName,staticStyle:{height:"230px"},attrs:{id:t.refName}})},d=[],p=(a("cd1e"),a("ebb5")),h={name:"ChartOneCom",components:{},mixins:[p["a"]],props:{title:{type:String,default:""},refName:{type:String,default:""},chartData:{type:Object,default:function(){return{}}}},data:function(){return{options:{}}},mounted:function(){this.screenWidth=window.screen.width||document.documentElement.clientWidth,this.screenHeight=window.screen.height||document.documentElement.clientHeight,this.screenWidth&&(1024===this.screenWidth||this.screenWidth<1024)&&(this.zoom=.8),this.resize(),this.init(),this.resize()},methods:{init:function(){var t=["数量","价格"],e=[{name:"数量",type:"bar",data:this.chartData.materialNum,barWidth:20},{name:"价格",type:"line",yAxisIndex:1,data:this.chartData.materialPrice}],a=this.chartData.purchaseDate;this.getCompleteOptions(t,e,a)},getCompleteOptions:function(t,e,a){this.options={title:{text:this.title,left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},legend:{data:t,left:"left",top:20},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},yAxis:[{type:"value",axisLabel:{formatter:"{value}"}},{type:"value",axisLabel:{formatter:"{value}"}}],xAxis:{type:"category",axisLabel:{show:!0,interval:0,rotate:-45,formatter:function(t){var e="",a=t.length,i=7,r=Math.ceil(a/i);if(a>i)for(var n=0;n<r;n++){var l="",o=n*i,s=o+i;l=n===r-1?t.substring(o,a):t.substring(o,s)+"\n",e+=l}else e=t;return e}},data:a},series:e};var i=this.$refs[this.refName];this.chart=i&&this.$echarts.init(i,"macarons"),i&&this.chart.setOption(this.options),this.chart&&this.chart.resize()}}},m=h,b=a("2877"),y=Object(b["a"])(m,f,d,!1,null,"7db51395",null),g=y.exports,v={name:"ChartsCom",components:{Chart:g},props:{data:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{reset:function(){},handleUploadImg:function(){}}},x=v,C=Object(b["a"])(x,c,u,!1,null,"7806253d",null),D=C.exports,w=a("1790"),O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-drawer",{attrs:{center:!0,"append-to-body":!0,"close-on-press-escape":!1,"wrapper-closable":!1,title:t.title,visible:t.value,size:750,"destroy-on-close":!0,direction:"btt","before-close":t.beforeClose},on:{open:t.initSelect}},[a("el-scrollbar",{staticClass:"query-more-scroll-drawer"},[a("el-row",[a("table-com",{ref:t.refName,attrs:{loading:t.loading,index:!0,selection:!1,"table-column-sort":!0,"table-height-type":620,"form-ident":t.formIdent,"table-data":t.tableData,"column-list":t.columnList,"show-operate":!1,"refresh-key":t.refreshKey,"expand-list":t.expandList}})],1)],1),a("div",{staticClass:"drawer-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.confirmDialog}},[t._v("确 定")]),a("el-button",{on:{click:t.beforeClose}},[t._v("取 消")])],1)],1)},S=[],k={name:"CustomEditCom",mixins:[w["a"]],props:{value:{type:Boolean,default:!1},title:{type:String,default:"自定义统计编辑"},formIdent:{type:String,default:""},tableData:{type:Array,default:function(){return[]}},columnList:{type:Array,default:function(){return[]}},expandList:{type:Array,default:function(){return[]}}},data:function(){return{refName:"CustomEditComTable",refreshKey:(new Date).getTime(),form:{},loading:!1,rules:{},query:{}}},methods:{confirmDialog:function(t){this.$emit("dialogConfirm")},initSelect:function(){},beforeClose:function(t){this.tableData=new Array(0),this.$emit("input",!1),"function"===typeof t&&t()}}},j=k,T=(a("9912"),Object(b["a"])(j,O,S,!1,null,"f0f84622",null)),L=T.exports,_=a("bc43");function $(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(_["a"])({url:"/statistics/wmsMaterialPriceAnalysis/pageList",method:"post",data:t})}function q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(_["a"])({url:"/statistics/wmsMaterialPriceAnalysis/materialPrice",method:"post",data:t})}var I=a("c1df"),P=a.n(I),N=a("ed08"),E=a("25ca"),A=a("21a6");function M(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function V(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?M(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}P.a.locale("zh-cn");var z={components:{ChartCom:D,EditDialog:L},mixins:[s["a"],w["a"]],data:function(){return{title:this.$route.meta.title,refTableName:"baseTableRef",refName:"table",loading:!1,chartList:[],query:{materialCode:"",startDate:"",endDate:""},tableData:[],columnList:[],columnSets:[],columnSetsInput:[],columnListInput:[],tableColumnSortData:[],dialogForm:{},supplierPullList:[],editType:"add",dialogVisible:!1,baseTableKey:1,collapseValue:"1",dialogTableData:[],dialogLoading:!1}},computed:{dialogTitle:function(){return"add"===this.editType?"新增".concat(this.title,"信息"):"编辑".concat(this.title,"信息")}},watch:{},mounted:function(){this.columnListInput=this.columnList.map((function(t){return V({},t,{module:"input"})})),this.query.materialCode&&this.initChart(),this.init()},methods:{initQueryTime:function(){this.query.startDate=P()(new Date).subtract(1,"months").format("YYYY-MM-DD"),this.query.endDate=P()(new Date).format("YYYY-MM-DD")},init:function(t){var e=this;this.loading=!0;var a=V({},this.query,{page:V({},this.pageInfo)});return new Promise((function(t,i){$(V({},a)).then((function(a){var i=a.code,r=a.data;if(!i){e.baseTableKey++;var n=r.formIdent,o=r.formHeadSets,s=r.pageData;e.formIdent=n,e.columnList=e.initTableHeadMixins(o),e.columnListInput=e.initTableHeadMixins(o,"input","columnSetsInput");var c=s.list,u=Object(l["a"])(s,["list"]);e.initPage(u),e.tableData=c}e.loading=!1,t(a)})).catch((function(t){e.loading=!1,i(t)}))}))},initChart:function(){var t=this;return new Promise((function(e,a){q(V({},t.query)).then((function(a){var i=a.code,r=a.data;i||(t.chartList=Object.values(r),t.chartList.length&&t.collapseValue&&t.baseTableKey++),e(a)})).catch((function(t){a(t)}))}))},handleRowClick:function(t){var e=t.row,a=t.column;t.cell,t.event;if("操作"===a.label)return!1;this.rightObj=V({},e)},refresh:function(){this.init("clean")},onDialogConfirm:function(){this.tableData=this.dialogTableData,this.dialogVisible=!1},handleSubmitCustomData:function(){},handleExport:Object(N["a"])((function(){var t=this.$refs[this.refTableName].$refs[this.refName];t.$el.querySelector(".el-table__fixed")&&t.$el.removeChild(t.$el.querySelector(".el-table__fixed")),t.$el.querySelector(".el-table__fixed-right")&&t.$el.removeChild(t.$el.querySelector(".el-table__fixed-right"));var e=E["a"].table_to_book(t.$el),a=E["b"](e,{bookType:"xlsx",bookSST:!0,type:"array"});try{var i=(new Date).toLocaleString().replace(/\//g,"").replace(/:/g,"").replace(" ","");Object(A["saveAs"])(new Blob([a],{type:"application/octet-stream"}),"物料价格分析_".concat(i,".xlsx")),this.baseTableKey++}catch(r){}return a}),800,!1),setTable:function(){this.$refs[this.refTableName].sortDialogVisible=!0},handleSearch:function(){this.init(),this.query.materialCode&&this.initChart()},resetForm:function(t){this.$refs[t].resetFields(),this.searchInit(),this.query.materialCode&&this.initChart()},openDialog:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.dialogLoading=!0,t.next=3,this.$nextTick();case 3:setTimeout(Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dialogTableData=JSON.parse(JSON.stringify(e.tableData)),e.dialogVisible=!0,t.next=4,e.$nextTick();case 4:e.dialogLoading=!1;case 5:case"end":return t.stop()}}),t)}))),200);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},K=z,Y=Object(b["a"])(K,i,r,!1,null,"f2f124f4",null);e["default"]=Y.exports}}]);
//# sourceMappingURL=AnalysisMaterialPrice.ca256a9d.js.map