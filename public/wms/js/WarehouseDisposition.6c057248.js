(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["WarehouseDisposition"],{"321c":function(e,t,r){e.exports={menuText:"#bfcbd9",menuActiveText:"#409EFF",subMenuActiveText:"#f4f4f5",menuBg:"#304156",menuHover:"#263445",subMenuBg:"#1f2d3d",subMenuHover:"#001528",sideBarWidth:"210px",blue:"#324157","light-blue":"#3A71A8",red:"#C03639",pink:"#E65D6E",green:"#30B08F",tiffany:"#4AB7BD",yellow:"#FEC171",panGreen:"#30B08F",warning:"#E6A23C"}},"32a6":function(e,t,r){var a=r("241e"),i=r("c3a1");r("ce7e")("keys",(function(){return function(e){return i(a(e))}}))},"3ae4":function(e,t,r){"use strict";var a=r("6505"),i=r.n(a);i.a},6505:function(e,t,r){},7519:function(e,t,r){"use strict";var a=r("8b75"),i=r.n(a);i.a},"798b":function(e,t,r){"use strict";var a=r("321c"),i=r.n(a);i.a},"7ab5":function(e,t,r){"use strict";var a=r("8043"),i=r.n(a);i.a},8043:function(e,t,r){},"8aae":function(e,t,r){r("32a6"),e.exports=r("584a").Object.keys},"8b75":function(e,t,r){},a4bb:function(e,t,r){e.exports=r("8aae")},a8db:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var a=r("e265"),i=r.n(a),n=r("a4bb"),o=r.n(n);function l(e,t){if(null==e)return{};var r,a,i={},n=o()(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(i[r]=e[r]);return i}function s(e,t){if(null==e)return{};var r,a,n=l(e,t);if(i.a){var o=i()(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}},ab77:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"clearfix top-filter"},[r("el-form",{ref:"filterItem",attrs:{model:e.query,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{staticClass:"fl",attrs:{prop:"materialCodeOrName"}},[r("el-input",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{clearable:"",placeholder:"物料编码或名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInit(t)}},model:{value:e.query.materialCodeOrName,callback:function(t){e.$set(e.query,"materialCodeOrName","string"===typeof t?t.trim():t)},expression:"query.materialCodeOrName"}})],1),r("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchInit}},[e._v("搜索")]),r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1),r("el-row",[r("table-com",{ref:"baseTableRef",attrs:{loading:e.loading,selection:!1,"table-column-sort":!0,"form-ident":e.formIdent,"table-data":e.tableData,"column-list":e.columnList,"operation-width":120,"table-height-type":690,"refresh-key":e.refreshKey,"expand-list":e.expandList,"show-operate":!1},on:{refresh:e.searchInit,rowClick:e.handleRowClick},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),r("pagination",{attrs:{page:e.pageInfo.current,limit:e.pageInfo.size,total:e.total},on:{"update:page":function(t){return e.$set(e.pageInfo,"current",t)},"update:limit":function(t){return e.$set(e.pageInfo,"size",t)},pagination:e.init}}),r("edit-dialog",{attrs:{"dialog-form":e.dialogForm,"edit-type":e.editType,title:e.dialogTitle},on:{submit:e.init},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}})],1)},i=[],n=(r("8e6e"),r("ac6a"),r("456d"),r("a8db")),o=r("bd86"),l=r("2f62"),s=r("1790"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-drawer",{attrs:{center:!0,"append-to-body":!0,"close-on-press-escape":!1,"wrapper-closable":!1,title:e.title,size:"50",visible:e.value,"destroy-on-close":!0,"before-close":e.beforeClose},on:{open:e.initSelect}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[r("el-scrollbar",{staticClass:"scroll-drawer"},[r("el-form-item",{attrs:{label:"移出仓库",prop:"warehouseId"}},[r("el-select",{staticStyle:{width:"178px"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{change:e.changeWarehouse},model:{value:e.form.warehouseId,callback:function(t){e.$set(e.form,"warehouseId",t)},expression:"form.warehouseId"}},e._l(e.warehousePullList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"移出物料",prop:"materialId"}},[r("el-link",{staticStyle:{"min-width":"178px"},attrs:{disabled:!e.form.warehouseId,type:"primary"},on:{click:e.openMaterialDlg}},[e._v("\n          "+e._s(e.form.materialId?e.form.materialName:"请选择")+"\n        ")])],1),r("el-form-item",{attrs:{label:"条码",prop:"wmsBillTransferStorageList"}},[r("el-link",{staticStyle:{width:"178px"},attrs:{disabled:!e.form.materialId,type:"primary"},on:{click:e.openBarcodeDlg}},[e._v("\n          请选择\n        ")])],1),e.form.wmsBillTransferStorageList.length?r("el-row",{staticStyle:{"margin-bottom":"18px","padding-left":"120px","box-sizing":"border-box"}},e._l(e.form.wmsBillTransferStorageList,(function(t,a){return r("el-tag",{key:a,staticClass:"my-el-tag",attrs:{hit:"",closable:"","disable-transitions":!1},on:{close:function(t){return e.handleClose(a)}}},[e._v("\n          "+e._s(t.barCode)+"\n        ")])})),1):e._e(),r("el-form-item",{attrs:{label:"移入位置",prop:"inStorageId"}},[r("el-link",{staticStyle:{"min-width":"178px"},attrs:{disabled:!(e.form.warehouseId&&e.form.materialId&&e.form.wmsBillTransferStorageList.length),type:"primary"},on:{click:e.openKuweiDlg}},[e._v("\n          "+e._s(e.form.inStorageId?e.form.inStorageName:"请选择")+"\n        ")])],1),r("el-row",{staticStyle:{padding:"0 15px","box-sizing":"border-box"}},[r("table-com",e._b({ref:e.refName,attrs:{"operation-width":120,"table-height-type":550,index:!0,"index-fixed":!1,selection:!1,multiple:!1,"selection-fixed":!1,"table-column-sort":!1,"table-data":e.tableData,"column-list":e.columnList,"show-operate":!0,"operate-fixed":!1,"table-selection":[],selectable:function(){return!0}},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.handleDeleteBarcode(t.row,t.index)}}},[e._v("删除")])]}}])},"table-com",e.$attrs,!1))],1)],1),r("div",{staticClass:"drawer-footer"},[r("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.handleConfirm("form")}}},[e._v(e._s(e.loading?"提交中 ...":"确 定"))]),r("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1),r("material-dialog",{attrs:{multiple:!1,selection:e.form.dataId?[e.form.dataId]:[],"extra-info":{warehouseId:e.form.warehouseId,forBusiness:"billTransferStorage"}},on:{confirm:e.onSelectedMaterial},model:{value:e.materialVisible,callback:function(t){e.materialVisible=t},expression:"materialVisible"}}),r("material-barcode",{attrs:{selection:e.form.wmsBillTransferStorageList?e.form.wmsBillTransferStorageList.map((function(e){return e.id})):[],"extra-info":{materialId:e.form.materialId,warehouseId:e.form.warehouseId,excludeIds:e.tableData.map((function(e){return e.barCodeId}))},"show-operate":!1},on:{confirm:e.onSelectedBarcode,syncBarcode:e.syncBarcode},model:{value:e.barcodeVisible,callback:function(t){e.barcodeVisible=t},expression:"barcodeVisible"}}),e.kuweiVisible?r("storage-location",{attrs:{"warehouse-id":e.form.warehouseId,"extra-info":{materialCode:e.form.materialCode}},on:{confirm:e.selectedStorageLocation},model:{value:e.kuweiVisible,callback:function(t){e.kuweiVisible=t},expression:"kuweiVisible"}}):e._e()],1)},u=[],d=(r("7514"),r("7f7f"),r("75fc")),f=(r("6762"),r("2fdb"),r("768b")),m=r("bc43");function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(m["a"])({url:"/warehouseMgt/wmsBillTransferStorage/pageList",method:"post",data:e})}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(m["a"])({url:"/warehouseMgt/wmsBillTransferStorage/add",method:"post",data:e})}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(m["a"])({url:"/warehouseMgt/wmsBillTransferStorage/edit",method:"post",data:e})}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(m["a"])({url:"/warehouseMgt/wmsBillTransferStorage/del",method:"post",data:e})}var w=r("09db"),y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:e.title,top:"5vh",visible:e.value,"show-close":!0,width:"920px","lock-scroll":!1,"destroy-on-close":!0,"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.beforeClose},on:{open:e.initSelect}},[r("el-scrollbar",{staticClass:"scroll-dialog"},[r("el-form",{ref:"filterItem",attrs:{model:e.query,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[r("el-form-item",{attrs:{prop:"materialCodeOrName"}},[r("el-input",{staticClass:"filter-item",staticStyle:{width:"178px"},attrs:{placeholder:"物料编号或名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchInit(t)}},model:{value:e.query.materialCodeOrName,callback:function(t){e.$set(e.query,"materialCodeOrName","string"===typeof t?t.trim():t)},expression:"query.materialCodeOrName"}})],1),r("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchInit}},[e._v("搜索")]),r("el-button",{staticClass:"filter-item",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("filterItem")}}},[e._v("重置")])],1),r("el-row",[r("table-com",{ref:e.refName,attrs:{"table-height-type":450,loading:e.loading,index:!0,"index-fixed":!1,selection:!0,multiple:e.multiple,"selection-fixed":!1,"table-column-sort":!1,"table-data":e.tableData,"column-list":e.columnList,"show-operate":!1,"operate-fixed":!1,"table-selection":e.tableSelection},on:{selectionChange:e.selectionChange}})],1),r("pagination",{attrs:{page:e.pageInfo.current,limit:e.pageInfo.size,total:e.total},on:{"update:page":function(t){return e.$set(e.pageInfo,"current",t)},"update:limit":function(t){return e.$set(e.pageInfo,"size",t)},pagination:e.init}})],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.confirmDialog}},[e._v("确 定")]),r("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1)},v=[],O=(r("c5f6"),r("ec26")),S=r("72ba");function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j={name:"MaterialSelect",mixins:[s["a"]],props:{value:{required:!0,type:Boolean},title:{type:String,default:"物料选择"},multiple:{type:Boolean,default:!0},selection:{type:Array,default:function(){return[]}},max:{type:Number,default:0},ids:{type:Array,default:function(){return[]}},extraInfo:{type:Object,default:function(){}}},dicts:[],data:function(){return{loading:!1,refName:"modelSelectMaterialSelect",query:{materialCodeOrName:""},tableData:[],columnList:[{module:"word",prop:"materialCode",label:"物料编号",align:"center",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialName",label:"物料名称",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialSpec",label:"规格型号",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"assessType_dictText",label:"评估类型",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center"},{module:"word",prop:"barcodeNum",label:"条码数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"inventoryNum",label:"实时库存",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}],columnSets:[],tableSelection:[],deptSelectedInfo:{list:[],visible:!1,radio:""}}},methods:{confirmDialog:function(){this.$emit("confirm",this.tableSelection),this.beforeClose()},init:function(){var e=this,t=x({},this.query,{},this.extraInfo,{page:x({},this.pageInfo)});return new Promise((function(r,a){Object(S["g"])(x({},t)).then((function(t){var a=t.code,i=t.data;if(!a){var o=i.pageData,l=o.list,s=Object(n["a"])(o,["list"]);e.initPage(s),e.tableData=l.map((function(e){return x({uuid:Object(O["a"])(),deliveryNumber:e.orderNum},e)})),e.tableSelection=e.tableData.filter((function(t){return e.selection.includes(t.id)}))}e.loading=!1,r(t)})).catch((function(t){e.loading=!1,a(t)}))}))},initSelect:function(){this.init()},selectionChange:function(e){this.tableSelection=Object(d["a"])(e)},handleUpdateTableSelected:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]},handleDefault:function(){this.tableSelection=new Array(0)},beforeClose:function(e){this.$emit("input",!1),this.handleDefault(),this.resetForm("filterItem"),"function"===typeof e&&e()},onDeptSelectConfirm:function(e){e.length&&(this.query.usedOffice=e[0].name)},resetForm:function(e){this.$refs[e].resetFields(),this.searchInit()}}},C=j,k=(r("7519"),r("2877")),D=Object(k["a"])(C,y,v,!1,null,"5e14ef83",null),L=D.exports,B=r("1f49"),_=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-drawer",{attrs:{title:e.title,visible:e.value,"append-to-body":"","destroy-on-close":"","before-close":e.beforeClose,"close-on-press-escape":!1,direction:e.direction,size:e.size,"wrapper-closable":!1,"custom-class":"user-drawer"}},[r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.pageLoading,expression:"pageLoading"}]},[r("el-scrollbar",{staticClass:"scroll-drawer"},[r("div",{staticClass:"draw-container"},[e.districtData.length?r("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.districtData,(function(t,a){return r("el-tab-pane",{key:a,attrs:{name:t.warehouseId+"-"+t.id}},[r("span",{attrs:{slot:"label"},slot:"label"},[r("span",{staticStyle:{"font-size":"18px","font-weight":"bold"}},[e._v(e._s(""+t.name+t.level_dictText))]),r("span",{staticStyle:{color:"#909399"}},[e._v(e._s(e._f("sapKuStr")(t.sapName)))])]),e.subzoneData.length?r("div",{staticClass:"huojia-sty"},e._l(e.subzoneData,(function(t,i){return r("div",{key:i},[r("el-card",{attrs:{"body-style":{minHeight:"325px",width:e.getHjWidth(t.children)}}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("div",{staticStyle:{"text-align":"center",cursor:"pointer"},on:{click:function(r){return e.chooseHuoJia(t)}}},[e._v(e._s(t.name)+"架")])]),t.children.length?[e._l(t.children,(function(t,n){return[r("div",{key:n,staticClass:"tier"},[r("div",{staticClass:"floor-name-sty",on:{click:function(r){return e.chooseCeng(t)}}},[e._v(e._s(t.name)+"层")]),[r("div",{staticClass:"ceng-wrapper"},[t.children.length?r("div",{staticClass:"parent"},e._l(t.children,(function(t,o){return r("div",{key:o,staticClass:"child",style:{backgroundColor:!t.empty||e.allStorageId.includes(t.storageId)?"#FFF5A7":"#A4E49C"}},[t.empty?r("div",{staticStyle:{cursor:"pointer"},on:{click:function(r){return e.chooseKuwei(t)}}},[e._v("\n                                  "+e._s(t.name)+"位\n                                ")]):r("el-popover",{key:"popover-"+a+"-"+i+"-"+n+"-"+o,ref:"popover-"+a+"-"+i+"-"+n+"-"+o,refInFor:!0,attrs:{"close-delay":0,"open-delay":300,placement:"top",width:"200",trigger:"hover","popper-class":"user-el-popover","visible-arrow":!1},on:{show:function(r){return e.getMaterialsInformation(t,"popover-"+a+"-"+i+"-"+n+"-"+o)}}},[r("el-descriptions",{staticClass:"user-el-descriptions",attrs:{column:1}},[r("el-descriptions-item",{attrs:{label:"物料编号"}},[e._v("\n                                      "+e._s(e.materialInfo.materialCode||"无")+"\n                                    ")]),r("el-descriptions-item",{attrs:{label:"物料名称"}},[e._v("\n                                      "+e._s(e.materialInfo.materialName||"无")+"\n                                    ")]),r("el-descriptions-item",{attrs:{label:"供应商"}},[e._v("\n                                      "+e._s(e.materialInfo.supplierName||"无")+"\n                                    ")]),r("el-descriptions-item",{attrs:{label:"库存总数"}},[e._v("\n                                      "+e._s(e.materialInfo.total||"无")+"\n                                    ")]),r("el-descriptions-item",{attrs:{label:"当前库位数量"}},[e._v("\n                                      "+e._s(e.materialInfo.num||"无")+"\n                                    ")])],1),r("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},on:{click:function(r){return e.chooseKuwei(t)}},slot:"reference"},[e._v(e._s(t.name)+"位")])],1)],1)})),0):r("div",{staticClass:"whole-floor"}),r("div",{staticClass:"divider"})])]],2)]}))]:[r("div",{staticClass:"entire-shelf"})]],2)],1)})),0):e._e()])})),1):e._e()],1)]),e._e()],1)])},P=[],N=(r("28a5"),r("ac4d"),r("8a81"),r("96cf"),r("3b8d")),T=(r("a481"),r("e60a")),W=r("fa7d");function $(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z={name:"AddBomNodeDrawerComs",components:{},filters:{sapKuStr:function(e){var t="";return e.replace(/\((.*?)\)/g,(function(e,r){t=r})),"(".concat(t,"库)")}},props:{value:{required:!0,type:Boolean,default:!1},title:{type:String,default:"选择库位"},direction:{type:String,default:"btt"},size:{type:String,default:"95%"},warehouseId:{type:[Number,String],default:""},extraInfo:{type:Object,default:function(){return{}}}},data:function(){return{activeName:"",warehousePullList:[],query:{warehouseId:""},districtData:[],materialInfo:{},pageLoading:!1,subzoneData:[]}},computed:A({},Object(l["c"])("app",{yiweiBindStorageLocation:"yiweiBindStorageLocation"}),{allStorageId:function(){return this.yiweiBindStorageLocation.map((function(e){return e.inStorageId}))}}),mounted:function(){var e=this;this.getWarehousePullList().then((function(t){e.query.warehouseId=e.warehousePullList[0].id,e.selectWarehouse(e.warehousePullList[0].id)}))},methods:{handleConfirm:function(){},chooseDistrict:function(){var e=Object(N["a"])(regeneratorRuntime.mark((function e(t){var r,a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.isAuth,a=t.currentPosition,i=t.storageId,e.next=3,Object(W["b"])(this.$confirm("是否选择（".concat(a,"）?"),"提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1,distinguishCancelAndClose:!0,closeOnPressEscape:!1,closeOnClickModal:!1,showClose:!1}));case 3:if(n=e.sent,n.success){e.next=7;break}return this.$emit("input",!1),e.abrupt("return");case 7:if(r){e.next=10;break}return this.$notify.warning({title:"警告",message:"当前库位暂无权限，请重新选择！"}),e.abrupt("return");case 10:this.$emit("confirm",{currentPosition:a,storageId:i}),this.$emit("input",!1);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),beforeClose:function(e){var t=!0,r=!1,a=void 0;try{for(var i,n=this.districtData[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var o=i.value;if("".concat(o.warehouseId,"-").concat(o.id)===this.activeName)return void this.chooseDistrict(o)}}catch(l){r=!0,a=l}finally{try{t||null==n.return||n.return()}finally{if(r)throw a}}this.$emit("input",!1),"function"===typeof e&&e()},getWarehousePullList:function(){var e=this;return new Promise((function(t,r){Object(w["g"])({warehouseId:null}).then((function(r){var a=r.code,i=r.data;a||(e.warehousePullList=i||[]),t(r)})).catch((function(e){r(e)}))}))},getBelowTheZoneList:function(){var e=Object(N["a"])(regeneratorRuntime.mark((function e(t,r){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["c"])(Object(T["b"])({warehouseSapId:null,warehouseId:t,parentId:r}));case 2:if(a=e.sent,a.success){e.next=5;break}return e.abrupt("return");case 5:this.subzoneData=a.data;case 6:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),selectWarehouse:function(){var e=Object(N["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(W["c"])(Object(T["c"])({warehouseSapId:null,warehouseId:t,parentId:null}));case 2:if(r=e.sent,r.success){e.next=5;break}return e.abrupt("return");case 5:this.districtData=r.data,this.activeName=this.districtData.length?"".concat(this.districtData[0].warehouseId,"-").concat(this.districtData[0].id):"",this.districtData.length&&this.getBelowTheZoneList(this.districtData[0].warehouseId,this.districtData[0].id);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getMaterialsInformation:function(){var e=Object(N["a"])(regeneratorRuntime.mark((function e(t,r){var a,i,n,o,l,s,c,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a in this.$refs)-1!==a.indexOf("popover-")&&a!==r&&this.$refs[a][0]&&this.$refs[a][0].doClose();return i=t.storageId,e.next=4,Object(W["c"])(Object(w["e"])({storageId:i}));case 4:if(n=e.sent,n.success){e.next=7;break}return e.abrupt("return");case 7:o=n.data,l=[],s=[],c=[],u=[],d=[],o.forEach((function(e){l.push(e.materialCode),s.push(e.materialName),c.push(e.supplierName),u.push(e.total),d.push(e.num)})),this.materialInfo={materialCode:l.join(),materialName:s.join(),supplierName:c.join(),total:u.join(),num:d.join()};case 15:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),handleTabClick:function(e,t){this.getBelowTheZoneList(this.activeName.split("-")[0],this.activeName.split("-")[1])},chooseHuoJia:function(e){this.chooseLocation(e)},chooseCeng:function(e){this.chooseLocation(e)},chooseKuwei:function(e){if(e.empty){var t=this.yiweiBindStorageLocation.filter((function(t){return t.inStorageId===e.storageId})),r=t.map((function(e){return e.materialCode}));if(r.length&&!r.includes(this.extraInfo.materialCode))return void this.$notify.warning({title:"警告",message:"当前库位已被其他物料绑定，请重新选择！"})}else if(this.materialInfo.materialCode&&this.extraInfo.materialCode!==this.materialInfo.materialCode)return void this.$notify.warning({title:"警告",message:"当前库位已被其他物料绑定，请重新选择！"});this.chooseLocation(e)},chooseLocation:function(){var e=Object(N["a"])(regeneratorRuntime.mark((function e(t){var r,a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.isAuth,a=t.currentPosition,i=t.storageId,e.next=3,Object(W["b"])(this.$confirm("是否选择（".concat(a,"）?"),"提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1}));case 3:if(n=e.sent,n.success){e.next=6;break}return e.abrupt("return");case 6:if(r){e.next=9;break}return this.$notify.warning({title:"警告",message:"当前库位暂无权限，请重新选择！"}),e.abrupt("return");case 9:this.$emit("confirm",{currentPosition:a,storageId:i}),this.$emit("input",!1);case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getHjWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(e&&e.length){var t=e.some((function(e){return e.children&&e.children.length>5&&e.children.length<=10})),r=e.some((function(e){return e.children&&e.children.length>10&&e.children.length<=15})),a=e.some((function(e){return e.children&&e.children.length>15&&e.children.length<=20}));return t?"660px":r?"960px":a?"1260px":"360px"}return"360px"}}},E=z,F=(r("7ab5"),r("798b"),Object(k["a"])(E,_,P,!1,null,"2b564fc0",null)),M=F.exports;function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var R=function(){return{dataId:"",materialId:"",materialName:"",materialCode:"",inStorageId:"",inStorageName:"",outStorageId:"",warehouseId:"",warehouseName:"",wmsBillTransferStorageList:[]}},H={components:{MaterialDialog:L,MaterialBarcode:B["a"],StorageLocation:M},mixins:[s["a"]],props:{value:{type:Boolean,default:!1},title:{type:String,default:""},editType:{type:String,default:"add"},dialogForm:{type:Object,default:function(){return q({},R())}}},data:function(){return{form:R(),loading:!1,materialVisible:!1,rules:{},gradeOpts:[],barcodeVisible:!1,dynamicTagsdynamicTags:[],kuweiVisible:!1,warehousePullList:[],refName:"modelSelectMaterialSelect",tableData:[],columnList:[{module:"word",prop:"warehouseName",label:"移出仓库",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialName",label:"移出物料",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"barCode",label:"条码",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"inStorageName",label:"移入位置",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}]}},computed:q({},Object(l["c"])("app",{navbarWarehouseCheckedList:"navbarWarehouseCheckedList",yiweiBindStorageLocation:"yiweiBindStorageLocation"})),watch:{dialogForm:{handler:function(e){"add"===this.editType?this.form=q({},R()):this.form=q({},e)},immediate:!0},"form.materialId":{handler:function(e){this.form.wmsBillTransferStorageList=[]}}},methods:q({},Object(l["b"])("app",["addYiWeiBindSl","delYiWeiBindSl","cleanYiWeiBindSl"]),{initSelect:function(){this.getWarehousePullList()},onSelectedMaterial:function(e){var t=Object(f["a"])(e,1),r=t[0];this.form.dataId=r.id,this.form.materialId=r.materialId,this.form.materialName=r.materialName,this.form.materialCode=r.materialCode,this.$refs.form.validateField("materialId")},openMaterialDlg:function(){this.materialVisible=!0},openBarcodeDlg:function(){this.form.materialId?this.barcodeVisible=!0:this.$message({message:"请先选择物料",type:"warning"})},onSelectedBarcode:function(e){if(e.length){var t=e.map((function(e){return{barCode:e.barcodeNumber,barCodeId:e.id,outStorageId:e.storageId,inventoryBookDetailId:e.id}}));if(t.length&&t.some((function(e){return!e.barCode})))return void this.$message({message:"请去条码管理去生成条码！",type:"warning"});this.form.wmsBillTransferStorageList=t}else this.form.wmsBillTransferStorageList=[];this.$refs.form.validateField("wmsBillTransferStorageList")},syncBarcode:function(e){this.form.inventoryList=this.form.inventoryList.filter((function(t){return t.id!==e.id}))},handleClose:function(e){this.form.wmsBillTransferStorageList.splice(e,1)},openKuweiDlg:function(){this.kuweiVisible=!0},selectedStorageLocation:function(e){var t=this,r=e.currentPosition,a=e.storageId;this.form.inStorageName=r,this.form.inStorageId=a,this.$refs.form.validateField("inStorageId");var i=this.form.wmsBillTransferStorageList.map((function(e){return{id:null,barCode:e.barCode,barCodeId:e.barCodeId,outStorageId:e.outStorageId,warehouseId:t.form.warehouseId,inventoryBookDetailId:e.inventoryBookDetailId,warehouseName:t.form.warehouseName,materialName:t.form.materialName,inStorageId:t.form.inStorageId,inStorageName:t.form.inStorageName,materialCode:t.form.materialCode,materialId:t.form.materialId}})),n=this.yiweiBindStorageLocation.map((function(e){return e.barCode}));i.forEach((function(e){n.includes(e.barCode)?t.$notify.warning({title:"警告",message:"存在重复条码，已自动去重！"}):(t.addYiWeiBindSl(e),t.tableData=[].concat(Object(d["a"])(t.tableData),[e]))})),this.form=R()},getWarehousePullList:function(){var e=this;return new Promise((function(t,r){Object(w["h"])().then((function(r){var a=r.code,i=r.data;a||(e.warehousePullList=i||[]),t(r)})).catch((function(e){r(e)}))}))},handleDeleteBarcode:function(e,t){var r=this;this.$confirm("此操作将永久删除该移位信息, 是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1}).then((function(){r.tableData.splice(t,1),r.delYiWeiBindSl(e),r.$notify.success({title:"成功",message:"删除成功"})})).catch((function(e){r.$notify.info({title:"消息",message:"已取消删除"})}))},changeWarehouse:function(e){this.form.warehouseName=this.warehousePullList.find((function(t){return t.id===e})).name,this.form.dataId="",this.form.materialId="",this.form.materialName="",this.form.materialCode="",this.form.inStorageId="",this.form.inStorageName="",this.form.outStorageId="",this.form.wmsBillTransferStorageList=[]},beforeClose:function(e){this.$refs.form.resetFields(),this.$emit("input",!1),this.form=Object.assign({},q({},R())),this.tableData=[],this.cleanYiWeiBindSl(),"function"===typeof e&&e()},handleConfirm:function(e){var t=this,r={add:p,modify:b}[this.editType];this.$refs[e].validate((function(e){if(!e)return!1;t.tableData.length?(t.loading=!0,r(q({},"add"===t.editType&&{wmsBillTransferStorageList:t.tableData.map((function(e){var t=e.barCode,r=e.outStorageId,a=e.warehouseId,i=e.inStorageId,n=e.inventoryBookDetailId,o=e.materialCode,l=e.inStorageName,s=e.materialId;return{id:null,barCode:t,outStorageId:r,warehouseId:a,inStorageId:i,inventoryBookDetailId:n,materialCode:o,inStorageName:l,materialId:s}}))})).then((function(e){var r=e.code;r||(t.$message({message:"".concat(t.title,"成功"),type:"success"}),t.$emit("submit"),t.beforeClose()),t.loading=!1})).catch((function(e){t.loading=!1}))):t.$message({message:"移位信息不能为空",type:"warning"})}))}})},K=H,Y=(r("3ae4"),Object(k["a"])(K,c,u,!1,null,"10d56283",null)),J=Y.exports,Z=r("e08f");function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){Object(o["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q={name:"WarehouseDisposition",components:{EditDialog:J},mixins:[s["a"],Z["a"]],data:function(){return{title:this.$route.meta.title,loading:!1,query:{materialCodeOrName:""},tableData:[],columnList:[{module:"word",prop:"materialCode",label:"物料编号",align:"center",minWidth:"150",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialName",label:"物料名称",align:"center",minWidth:"100",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"materialSpec",label:"规格型号",align:"center",minWidth:"100",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"assessType_dictText",label:"评估类型",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,headerAlign:"center"},{module:"word",prop:"barCode",label:"条码号",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"number",label:"数量",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"unitName",label:"计量单位",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"outStorageName",label:"移出位置",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"inStorageName",label:"移入位置",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"},{module:"word",prop:"date",label:"移位时间",align:"center",minWidth:"",fixed:!1,sortable:!1,resizable:!0,formatter:null,headerAlign:"center"}],columnSets:[],dialogForm:{},editType:"add",dialogVisible:!1}},computed:U({dialogTitle:function(){var e={add:"新增移位信息",edit:"修改移位信息"};return e[this.editType]}},Object(l["c"])("app",{navbarWarehouseCheckedList:"navbarWarehouseCheckedList"})),watch:{navbarWarehouseCheckedList:{handler:function(){this.init()},deep:!0}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.loading=!0;var t=U({page:U({},this.pageInfo)},this.query,{warehouseIds:this.navbarWarehouseCheckedList.map((function(e){return e.id}))});return new Promise((function(r,a){h(U({},t)).then((function(t){var a=t.code,i=t.data;if(!a){var o=i.formIdent,l=i.formHeadSets,s=i.pageData;e.formIdent=o,e.columnList=e.initTableHeadMixins(l);var c=s.list,u=Object(n["a"])(s,["list"]);e.initPage(u),e.tableData=c}e.loading=!1,r(t)})).catch((function(t){e.loading=!1,a(t)}))}))},handleRowClick:function(e){var t=e.row,r=e.column;e.cell,e.event;if("操作"===r.label)return!1;this.rightObj=U({},t)},refresh:function(){this.init("clean")},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除选中信息, 是否继续?","提示",{confirmButtonText:"确 定",cancelButtonText:"取 消",type:"warning",cancelButtonClass:"btn-custom-cancel",lockScroll:!1}).then((function(){g({id:e.id}).then((function(e){var r=e.code;r||(t.$notify.success({title:"成功",message:"删除成功"}),t.init())}))})).catch((function(e){t.$notify.info({title:"消息",message:"已取消删除"})}))},handleAdd:function(){this.editType="add",this.dialogForm={},this.dialogVisible=!0},resetForm:function(e){this.$refs[e].resetFields(),this.searchInit()}}},X=Q,ee=Object(k["a"])(X,a,i,!1,null,"3380f549",null);t["default"]=ee.exports},ce7e:function(e,t,r){var a=r("63b6"),i=r("584a"),n=r("294c");e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],o={};o[e]=t(r),a(a.S+a.F*n((function(){r(1)})),"Object",o)}},e08f:function(e,t,r){"use strict";r("8e6e"),r("ac6a"),r("456d"),r("7514");var a=r("bd86");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(a["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}t["a"]={data:function(){return{formIdent:"",tableData:[],columnList:[],expandList:[],tableColumnSortData:[],labels:{},refreshKey:1}},methods:{initTableHeadMixins:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"word",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"columnSets",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=t.map((function(e){return n({isParam:!1},e,{width:"input"!==r||e.width?e.width:i,module:r})})).map((function(t){var r=e[a].find((function(e){return e.prop===t.prop}));return r?n({},t,{},r):n({},t)}));return this.$nextTick((function(){"word"===r&&(e.expandList=o.filter((function(e){return e.extend&&e.show})))})),this.$nextTick((function(){e.refreshKey+=1})),o.filter((function(e){return e.show&&!e.extend}))}}}},e265:function(e,t,r){e.exports=r("ed33")},e60a:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return n})),r.d(t,"d",(function(){return o})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"f",(function(){return d})),r.d(t,"i",(function(){return f}));var a=r("bc43");function i(e){return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/add",method:"post",data:e})}function n(e){return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/edit",method:"post",data:e})}function o(e){return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/delete",method:"post",data:e})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/treeList",method:"post",data:e,timeout:3e5})}function s(e){return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/detail",method:"post",data:e})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/childrenList",method:"post",data:e})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])({url:"/basic/wmsWarehouseStorageLocation/treeListByParentId",method:"post",data:e,timeout:3e5})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])({url:"/basic/wmsWarehouse/listItem",method:"post",data:e})}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])({url:"/basic/wmsWarehouseSap/detail",method:"post",data:e})}},ed33:function(e,t,r){r("014b"),e.exports=r("584a").Object.getOwnPropertySymbols}}]);
//# sourceMappingURL=WarehouseDisposition.6c057248.js.map