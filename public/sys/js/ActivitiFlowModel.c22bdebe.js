(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ActivitiFlowModel"],{1790:function(e,t,n){"use strict";t["a"]={data:function(){return{pageInfo:{current:1,size:10},pages:1,total:0}},methods:{initPage:function(e){var t=e.total,n=e.pageNum,i=e.pageSize;this.pageInfo.current=n,this.pageInfo.size=i,this.total=t},indexMethod:function(e){var t=this.pageInfo,n=t.current,i=t.size;return e+1+(n-1)*i},resetPage:function(){this.pageInfo={current:1,size:10},this.total=0}}}},"32a6":function(e,t,n){var i=n("241e"),o=n("c3a1");n("ce7e")("keys",(function(){return function(e){return o(i(e))}}))},"333d":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{class:"pagination-container "+e.className},[n("el-pagination",{class:e.pagiationClassName,attrs:{background:e.background,"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:e.layout,total:e.total,"hide-on-single-page":e.hideOnSinglePage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},o=[],a=(n("c5f6"),n("ed08")),r={name:"PaginationCom",components:{},props:{className:{type:String,default:"clearfix"},total:{required:!0,type:Number,default:10},page:{type:Number,default:1},limit:{type:Number,default:10},pageSizes:{type:Array,default:function(){return[10,20,30,50,100]}},layout:{type:String,default:"total, prev, pager, next, jumper, sizes"},background:{type:Boolean,default:!1},hideOnSinglePage:{type:Boolean,default:!1},autoScroll:{type:Boolean,default:!0}},computed:{pagiationClassName:function(){return"clearfix"===this.className?"fr":""},currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("update:limit",e),this.$emit("pagination"),this.autoScroll&&Object(a["c"])(0)},handleCurrentChange:function(e){this.$emit("pagination"),this.autoScroll&&Object(a["c"])(0)}}},l=r,s=n("2877"),c=Object(s["a"])(l,i,o,!1,null,null,null);t["a"]=c.exports},"5d58":function(e,t,n){e.exports=n("d8d6")},"67bb":function(e,t,n){e.exports=n("f921")},7618:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("5d58"),o=n.n(i),a=n("67bb"),r=n.n(a);function l(e){return l="function"===typeof r.a&&"symbol"===typeof o.a?function(e){return typeof e}:function(e){return e&&"function"===typeof r.a&&e.constructor===r.a&&e!==r.a.prototype?"symbol":typeof e},l(e)}},"8aae":function(e,t,n){n("32a6"),e.exports=n("584a").Object.keys},"9a2e":function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"inline-block"}},[n("el-upload",{ref:"upload",attrs:{sizi:"mini",action:""+e.BASE_API+e.url,headers:e.headers,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:e.limit>1,limit:e.limit,"on-exceed":e.handleExceed,"file-list":e.fileList,"on-preview":e.handlePreview,"show-file-list":e.showFileList,"on-success":e.handleUploadSuccess}},[e.btnContent?n("el-button",{attrs:{size:"mini",icon:e.btnIcon,type:e.btnType}},[e._v(e._s(e.btnContent))]):n("el-button",{attrs:{size:"mini",icon:e.btnIcon,type:e.btnType}}),e._t("tip")],2)],1)},o=[],a=(n("8e6e"),n("ac6a"),n("456d"),n("7f7f"),n("bd86")),r=n("a8db"),l=(n("c5f6"),n("4360")),s=n("c344");function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={name:"FormUploadFileComs",props:{env:{type:String,default:"VUE_APP_BASE_API"},uploadFileList:{type:Array,default:function(){return[]}},showFileList:{type:Boolean,default:!0},btnIcon:{type:String,default:""},btnType:{type:String,default:"primary"},btnContent:{type:String,default:"点击上传"},limit:{type:Number,default:1},errDefaultMsg:{type:String,default:"文件上传失败"},url:{type:String,default:"/sys/file/upload"}},data:function(){var e="".concat(l["a"].getters.token);return{fileList:[],BASE_API:Object({NODE_ENV:"production",VUE_APP_BASE_API:"https://192.168.1.7:9005/api/system",VUE_APP_BASE_API_ACTIVITI:"https://192.168.1.7:9005/api/flowable",VUE_APP_BASE_API_WMS:"https://192.168.1.7:9005/api/wms",VUE_APP_BASE_PUBLIC_PATH:"/sys",BASE_URL:"/sys/"})[this.env],headers:{Authorization:e},uploadDisabled:!1,list:[]}},watch:{uploadFileList:{handler:function(e){this.fileList=e.map((function(e){var t=e.fileName,n=e.fileUrl,i=Object(r["a"])(e,["fileName","fileUrl"]);return u({},i,{url:n,name:t})}))}}},methods:{handleUploadSuccess:function(e,t,n){if("导入成功"!==e){var i=e.code,o=e.data;if(i&&999===i)this.$notify({title:"错误",message:e.msg?e.msg:this.errDefaultMsg,type:"error"});else if(!i){var a=o.id,r=o.fileUrl,l=o.fileType,s=o.downloadUrl,c=o.fileName,u=o.suffix,d={id:a,fileUrl:r,fileType:l,downloadUrl:s,suffix:u,fileName:c,name:c,url:r,classification:""};this.fileList.push(d),this.$emit("uploadFileSuccess",d)}}else this.$emit("uploadFileSuccess")},handleRemove:function(e,t){var n=this,i=Object.assign({},e);return new Promise((function(e,t){Object(s["a"])({ids:[i.id]}).then((function(o){var a=o.code;a?t():(n.fileList=n.fileList.filter((function(e){return e.id!==i.id})),n.$emit("handleRemove",u({},i)),e())})).catch((function(e){t(e)}))}))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handlePreview:function(e){var t=e.id;window.open("".concat(this.BASE_API,"/sale/file/download/").concat(t))},handleExceed:function(e,t){this.$notify({title:"警告",message:"当前限制上传附件数量是 ".concat(this.limit," 个文件"),type:"warning"})}}},f=d,p=n("2877"),m=Object(p["a"])(f,i,o,!1,null,"3fab430a",null),b=m.exports,g={components:{FormUploadFile:b},data:function(){return{uploadTip:"",uploadFileList:[]}},methods:{uploadFileSuccess:function(e){this.uploadFileList.push(e)},handleRemove:function(e){var t=e.id;this.uploadFileList=this.uploadFileList.filter((function(e){return e.id!==t}))},initUploadFileList:function(e){var t=this;if(e&&"null"!==e)return new Promise((function(n,i){var o=JSON.parse(e);Object(s["b"])({ids:o}).then((function(e){var i=e.code,o=e.data;i||(t.uploadFileList=o),n(e)})).catch((function(e){i(e)}))}))},getFileIdList:function(){return this.uploadFileList.map((function(e){return e.id}))},resetFormUploadFilesMixins:function(){this.uploadFileList=[]},downloadUploadFileMixins:function(e){window.open("".concat("https://192.168.1.7:9005/api/system","/sys/file/download/").concat(e))}}}},a4bb:function(e,t,n){e.exports=n("8aae")},a8db:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("e265"),o=n.n(i),a=n("a4bb"),r=n.n(a);function l(e,t){if(null==e)return{};var n,i,o={},a=r()(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}function s(e,t){if(null==e)return{};var n,i,a=l(e,t);if(o.a){var r=o()(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}},c344:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return l}));var i=n("97af");function o(e,t){return Object(i["a"])({url:e,method:"post",data:t})}function a(e){return Object(i["a"])({url:"/sys/role/listView",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/sys/file/del",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/sys/file/list",method:"post",data:e})}},c6e2:function(e,t,n){"use strict";n("6b54");var i=n("bc3a"),o=n.n(i),a=n("5c96"),r=n("4360"),l=n("5f87"),s={baseURL:"".concat("https://192.168.1.7:9005/api/flowable"),withCredentials:!0,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}},c=o.a.create(s),u=!1;c.interceptors.request.use((function(e){return r["a"].getters.token&&(e.headers["Authorization"]="".concat(r["a"].getters.token)),e}),(function(e){Promise.reject(e)})),c.interceptors.response.use((function(e){return e&&e.data&&e.data.code&&999===e.data.code&&Object(a["Message"])({message:e.data.msg,type:"error",duration:5e3}),e.data}),(function(e){var t=0;try{t=e.response.status}catch(n){if(-1!==e.toString().indexOf("Error: timeout"))return Object(a["Message"])({message:"网络请求超时",type:"error",duration:5e3}),Promise.reject(e)}return 401===t||403===t?(u||(u=!0,Object(a["Message"])({message:"登录信息已过期或者没有访问权限",type:"error",duration:5e3}),setTimeout((function(){u=!1}),5e3)),r["a"].dispatch("resetToken").then((function(){setTimeout((function(){window.location.href=Object(l["b"])()}),3e3)})),Promise.reject(e)):(Object(a["Message"])({message:e,type:"error",duration:5e3}),Promise.reject(e))})),t["a"]=c},ce7e:function(e,t,n){var i=n("63b6"),o=n("584a"),a=n("294c");e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],r={};r[e]=t(n),i(i.S+i.F*a((function(){n(1)})),"Object",r)}},d5bb:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"clearfix top-filter"},[n("el-form",{ref:"filterItem",attrs:{model:e.query,inline:""}},[n("el-form-item",{staticClass:"fl",attrs:{prop:"code"}},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"按模型名称或标识搜索"},model:{value:e.query.code,callback:function(t){e.$set(e.query,"code",t)},expression:"query.code"}})],1),n("el-button",{staticClass:"filter-item fl",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.init}},[e._v("搜索")]),n("el-button",{staticClass:"filter-item fl",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("filterItem")}}},[e._v("重置")]),n("el-button",{staticClass:"filter-item fl",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")]),n("form-upload-file",{attrs:{"upload-file-list":e.uploadFileList,env:"VUE_APP_BASE_API_ACTIVITI",url:"/flow-manager/app/rest/models/import",limit:100,"show-file-list":!1,"btn-icon":"el-icon-upload","btn-content":"导入模型"},on:{uploadFileSuccess:e.uploadFileSuccess}},[n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.uploadTip))])])],1)],1),n("el-row",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[n("el-table-column",{attrs:{align:"center",type:"index",index:e.indexMethod,label:"序号"}}),e._l(e.formThead,(function(e){return n("el-table-column",{key:e.label,attrs:{label:e.label,prop:e.prop,align:"center"}})})),n("el-table-column",{attrs:{label:"操作",align:"center",width:"240px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:function(n){return e.handleUpload(t.row)}}}),n("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:function(n){return e.handleExport(t.row)}}}),n("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(n){return e.handleModify(t.row)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}})]}}])})],2)],1),n("pagination",{attrs:{page:e.pageInfo.current,limit:e.pageInfo.size,total:e.total},on:{"update:page":function(t){return e.$set(e.pageInfo,"current",t)},"update:limit":function(t){return e.$set(e.pageInfo,"size",t)},pagination:e.init}}),n("el-dialog",{attrs:{title:"add"===e.dialogType?"新增"+e.title:"修改"+e.title,"close-on-click-modal":!1,width:"450px","append-to-body":"","lock-scroll":!1,visible:e.dialogVisible,"before-close":e.beforeClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"form",attrs:{inline:"",model:e.form,rules:e.rules,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"模型名称",prop:"name"}},[n("el-input",{staticStyle:{width:"278px"},attrs:{placeholder:"请填写模型名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"模型标识",prop:"modelKey"}},[n("el-input",{staticStyle:{width:"278px"},attrs:{placeholder:"请填写模型标识"},model:{value:e.form.modelKey,callback:function(t){e.$set(e.form,"modelKey",t)},expression:"form.modelKey"}})],1),n("el-form-item",{attrs:{label:"模型描述",prop:"description"}},[n("el-input",{staticStyle:{width:"278px"},attrs:{type:"textarea",rows:5},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description","string"===typeof t?t.trim():t)},expression:"form.description"}})],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.dialogComfirm("form")}}},[e._v("确 定")]),n("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1),n("el-dialog",{attrs:{title:"请输入此"+e.title+"的 系统标识","close-on-click-modal":!1,width:"350px","append-to-body":"","lock-scroll":!1,visible:e.submitDialogVisible},on:{"update:visible":function(t){e.submitDialogVisible=t},open:function(){e.submitForm.tenantId="WMS"}}},[n("el-form",{ref:"submitForm",attrs:{model:e.submitForm,rules:e.submitRules,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"系统标识",prop:"tenantId"}},[n("el-select",{attrs:{placeholder:"请选择系统标识"},model:{value:e.submitForm.tenantId,callback:function(t){e.$set(e.submitForm,"tenantId",t)},expression:"submitForm.tenantId"}},e._l(e.sysOptions,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.submitAct("submitForm")}}},[e._v("确 定")]),n("el-button",{on:{click:function(t){e.submitDialogVisible=!1}}},[e._v("取 消")])],1)],1)],1)},o=[],a=(n("8e6e"),n("ac6a"),n("456d"),n("a8db")),r=n("bd86"),l=n("1790"),s=n("333d"),c=n("c6e2");function u(e){return Object(c["a"])({url:"/flow-manager/app/rest/models/pageList",method:"post",data:e})}function d(e){return Object(c["a"])({url:"/flow-manager/app/rest/models/create",method:"post",data:e})}function f(e){return Object(c["a"])({url:"/flow-manager/app/rest/models/del",method:"post",data:e})}function p(e){return Object(c["a"])({url:"/flow-manager/app/rest/process/deploy",method:"post",data:e})}var m=n("9a2e");function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h={name:"",modelKey:"",description:""},y={name:"ActivitiFlowModel",components:{Pagination:s["a"]},mixins:[l["a"],m["a"]],data:function(){return{title:"模型",loading:!1,query:{code:""},tableData:[],dialogType:"add",dialogVisible:!1,form:h,formThead:[{label:"流程版本",prop:"version"},{label:"流程名称",prop:"name"},{label:"名称标识",prop:"modelKey"},{label:"创建时间",prop:"created"},{label:"描述",prop:"description"}],rules:{name:[{required:!0,message:"请填写模型名称",trigger:"blur"}],modelKey:[{required:!0,message:"请填写模型标识",trigger:"blur"}]},submitDialogVisible:!1,submitForm:{tenantId:"SYS"},submitRules:{tenantId:[{required:!0,message:"请选择系统标识",trigger:"blur"}]},submitItem:{},sysOptions:[{value:"SYS",label:"SYS"},{value:"WMS",label:"WMS"}]}},mounted:function(){this.init()},methods:{init:function(){var e=this;return new Promise((function(t,n){e.loading=!0,u({cutData:g({},e.query),page:g({},e.pageInfo)}).then((function(n){var i=n.code,o=n.data;if(!i){var r=o.list,l=Object(a["a"])(o,["list"]);e.initPage(l),e.tableData=r}e.loading=!1,t(n)})).catch((function(t){e.loading=!1,n(t)}))}))},dialogComfirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,d(g({},t.form)).then((function(e){var n=e.code,i=e.data;n||(t.init(),t.handleModify(i),t.dialogVisible=!1),t.loading=!1})).catch((function(e){t.loading=!1}))}))},handleModify:function(e){var t=this.$router.resolve({name:"FullScreenWorkflow",query:{id:e.id}});window.open(t.href,"_blank")},handleUpload:function(e){this.submitItem=Object.assign({},g({},e)),this.submitDialogVisible=!0},submitAct:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var n=t.submitItem;p({id:n.id,tenantId:t.submitForm.tenantId}).then((function(e){var n=e.code;n||(t.$message({message:"发布成功",type:"success"}),t.init())}))}))},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除此条".concat(this.title,", 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",cancelButtonClass:"btn-custom-cancel",type:"warning",lockScroll:!1}).then((function(){f({ids:[e.id]}).then((function(e){var n=e.code;n||(t.$message({message:"删除成功",type:"success"}),t.init())}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},uploadFileSuccess:function(){this.$notify({title:"成功",message:"模型导入成功",type:"success"}),this.init()},handleExport:function(e){window.open("".concat("https://192.168.1.7:9005/api/flowable","/flow-manager/app/rest/models/loadXmlByModelId/").concat(e.id),"_blank")},handleAdd:function(){this.form=Object.assign({},g({},h)),this.dialogType="add",this.dialogVisible=!0},resetForm:function(e){this.$refs[e].resetFields(),this.init()},beforeClose:function(e){this.dialogVisible=!1,this.loading=!1,this.$refs.form.resetFields(),"function"===typeof e&&e()}}},v=y,w=n("2877"),O=Object(w["a"])(v,i,o,!1,null,"57d542b4",null);t["default"]=O.exports},e265:function(e,t,n){e.exports=n("ed33")},ed08:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));n("8615"),n("ac6a"),n("6762"),n("2fdb"),n("c5f6"),n("a481"),n("6b54");var i=n("7618");function o(e,t){if(0===arguments.length)return null;var n,o=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(i["a"])(e)?n=e:("string"===typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"===typeof e&&10===e.toString().length&&(e*=1e3),n=new Date(e));var a={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},r=o.replace(/{(y|m|d|h|i|s|a)+}/g,(function(e,t){var n=a[t];return"a"===t?["日","一","二","三","四","五","六"][n]:(e.length>0&&n<10&&(n="0"+n),n||0)}));return r}function a(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}Math.easeInOutQuad=function(e,t,n,i){return e/=i/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};var r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2?arguments[2]:void 0,i=l(),o=e-i,s=20,c=0,u=function e(){c+=s;var l=Math.easeInOutQuad(c,i,o,t);a(l),c<t?r(e):n&&"function"===typeof n&&n()};u()}},ed33:function(e,t,n){n("014b"),e.exports=n("584a").Object.getOwnPropertySymbols}}]);