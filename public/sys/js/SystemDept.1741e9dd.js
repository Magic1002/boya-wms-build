(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["SystemDept"],{"38de":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));n("8e6e"),n("ac6a"),n("456d");var i=n("a8db"),r=(n("a481"),n("7f7f"),n("bd86")),a=n("ca17"),s=n.n(a),o=(n("542c"),n("dc78"));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={components:{Treeselect:s.a},data:function(){return{defaultProps:{children:"children",label:"name",hasleaf:!0},depts:[]}},methods:{initOrigin:function(e,t){var n=this;return new Promise((function(t,i){Object(o["e"])({}).then((function(i){var r=i.code,a=i.data;r||(n.depts=e?n.mapDeptsTree(a):a.map((function(e){return l({},e,{label:e.name,children:null})}))),t(i)})).catch((function(e){i(e)}))}))},loadDepts:function(e){var t=e.action,n=e.parentNode,i=e.callback;if(t===a["LOAD_CHILDREN_OPTIONS"]){var r=n.id?{id:n.id}:{};Object(o["f"])(r).then((function(e){if(!e.code){var t=e.data;t=JSON.parse(JSON.stringify(t).replace(/name/g,"label").replace(/children/g,"children")),n.children=t.map((function(e){return e.hasleaf?e.children=null:delete e.children,e}))}setTimeout((function(){i()}),100)}))}},mapDeptsTree:function(e){var t=this;if(Array.isArray(e)&&e){var n=e.map((function(e){var n=e.name,r=e.children,a=Object(i["a"])(e,["name","children"]);if(e.hasleaf){var s=t.mapDeptsTree(r);return l({},a,{label:n,children:s})}return l({},a,{label:n})}));return n}}}},u={data:function(){return{deptsTreeLoadingMixins:!1,defaultPropsMixins:{children:"children",label:"name",isLeaf:function(e,t){return!t.data.hasleaf}},deptsMixins:[],depsDefaultExpandKeysMixins:[]}},methods:{initDepsMixins:function(e){var t=this,n=e||{name:this.depsFilterText};return new Promise((function(e,i){t.deptsTreeLoadingMixins=!0,Object(o["d"])(n).then((function(n){var i=n.code,r=n.data;i||(t.depsDefaultExpandKeysMixins=r.map((function(e){return e.id})),t.deptsMixins=r),t.deptsTreeLoadingMixins=!1,e(n)})).catch((function(e){t.deptsTreeLoadingMixins=!1,i(e)}))}))}}}},"5cfa":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"clearfix top-filter"},[n("el-form",{ref:"filterItem",attrs:{model:e.query,inline:""}},[n("el-form-item",{staticClass:"fl",attrs:{prop:"name"}},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"模糊搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.init(t)}},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}})],1),n("el-button",{staticClass:"filter-item fl",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.init}},[e._v("搜索")]),n("el-button",{staticClass:"filter-item fl",attrs:{type:"warning",icon:"el-icon-refresh-left"},on:{click:function(t){return e.resetForm("filterItem")}}},[e._v("重置")]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sys:office:add"],expression:"['sys:office:add']"}],staticClass:"filter-item fl",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1),n("el-row",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"default-expand-all":"",data:e.tableData,"row-key":"id",border:"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[n("el-table-column",{attrs:{prop:"name",label:"机构名称"}}),n("el-table-column",{attrs:{prop:"sort",label:"排序",align:"center"}}),n("el-table-column",{attrs:{prop:"isEnable",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{disabled:0===t.row.parentId},on:{change:function(n){return e.changeEnabled(t.row,t.row.isEnable)}},model:{value:t.row.isEnable,callback:function(n){e.$set(t.row,"isEnable",n)},expression:"scope.row.isEnable"}})]}}])}),n("el-table-column",{attrs:{prop:"updateDate",label:"更新日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.updateDate))])]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center",width:"140px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sys:office:edit"],expression:"['sys:office:edit']"}],attrs:{type:"primary",disabled:0===t.row.parentId,icon:"el-icon-edit"},on:{click:function(n){return e.handleUpdate(t.row)}}}),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sys:office:delete"],expression:"['sys:office:delete']"}],attrs:{type:"danger",disabled:0===t.row.parentId,icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}})]}}])})],1)],1),n("el-dialog",{attrs:{title:"add"===e.dialogType?"新增机构":"修改机构","close-on-click-modal":!1,width:"580px","append-to-body":"","lock-scroll":!1,visible:e.dialogVisible,"before-close":e.beforeClose},on:{"update:visible":function(t){e.dialogVisible=t},opened:function(){return e.initOrigin("add"!==e.dialogType)}}},[n("el-form",{ref:"form",attrs:{inline:"",model:e.form,rules:e.rules,size:"small","label-width":"100px"}},[n("el-form-item",{attrs:{label:"机构名称",prop:"name"}},[n("el-input",{staticStyle:{width:"370px"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"机构编码",prop:"code"}},[n("el-input",{staticStyle:{width:"370px"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),n("el-form-item",{attrs:{label:"机构排序",prop:"sort"}},[n("el-input-number",{staticStyle:{width:"130px"},attrs:{min:0,max:999,"controls-position":"right"},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",e._n(t))},expression:"form.sort"}})],1),n("el-form-item",{attrs:{label:"状态",prop:"isEnable","label-width":"70px"}},[n("el-radio-group",{staticStyle:{width:"140px"},model:{value:e.form.isEnable,callback:function(t){e.$set(e.form,"isEnable",t)},expression:"form.isEnable"}},[n("el-radio-button",{attrs:{label:!0}},[e._v("启用")]),n("el-radio-button",{attrs:{label:!1}},[e._v("禁用")])],1)],1),n("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"上级机构",prop:"parentId"}},[n("treeselect",{staticStyle:{width:"370px"},attrs:{"load-options":e.loadDepts,options:e.depts,placeholder:"选择上级机构"},model:{value:e.form.parentId,callback:function(t){e.$set(e.form,"parentId",t)},expression:"form.parentId"}})],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:function(t){return e.dialogComfirm("form")}}},[e._v("确 定")]),n("el-button",{on:{click:e.beforeClose}},[e._v("取 消")])],1)],1)],1)},r=[],a=(n("8e6e"),n("456d"),n("7f7f"),n("bd86")),s=(n("ac6a"),n("5df3"),n("ca17")),o=n.n(s),c=(n("542c"),n("dc78")),l=n("6f1e"),d=n("38de");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={name:"",code:"",sort:999,isEnable:!0,type:"",grade:"",parentId:null},m={name:"SystemDept",components:{Treeselect:o.a},mixins:[l["b"],l["a"],d["a"]],data:function(){return{loading:!1,query:{name:""},tableData:[],form:p,rules:{name:[{required:!0,message:"请输入机构名称",trigger:"blur"}],code:[{required:!0,message:"请输入机构编码",trigger:"blur"}],sort:[{required:!0,message:"请选择机构排序",trigger:"blur"}],isEnable:[{required:!0,message:"请选择机构排序",trigger:"blur"}],parentId:[{required:!0,message:"请选择上级机构",trigger:"change"}]},dialogType:"add",dialogVisible:!1}},created:function(){this.init(),Promise.all([this.initOfficeTypeOptsMixins(),this.initOfficeGradeOptsMixins()])},methods:{init:function(){var e=this;return new Promise((function(t,n){e.loading=!0,Object(c["e"])(f({},e.query,{queryAll:!0})).then((function(n){var i=n.code,r=n.data;i||(e.tableData=r,e.depts=r.map((function(e){return f({},e,{label:e.name,children:null})}))),e.loading=!1,t(n)})).catch((function(t){e.loading=!1,n(t)}))}))},dialogComfirm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if(t.loading=!0,"add"===t.dialogType)Object(c["a"])(f({},t.form)).then((function(e){var n=e.code;n||(t.$message({message:"新增机构成功",type:"success"}),t.init(),t.dialogVisible=!1),t.loading=!1})).catch((function(e){t.loading=!1}));else{var n=t.form;delete n.children,Object(c["c"])(f({},t.form)).then((function(e){var n=e.code;n||(t.$message({message:"修改机构成功",type:"success"}),t.init(),t.dialogVisible=!1),t.loading=!1})).catch((function(e){t.loading=!1}))}}))},handleAdd:function(){this.form=Object.assign({},f({},p)),this.dialogType="add",this.dialogVisible=!0},handleUpdate:function(e){var t=0===e.parentId?null:e.parentId;this.form=Object.assign({},f({},e,{parentId:t})),this.dialogType="update",this.dialogVisible=!0},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该机构, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",cancelButtonClass:"btn-custom-cancel",type:"warning",lockScroll:!1}).then((function(){e.id&&Object(c["b"])({id:e.id}).then((function(e){var n=e.code;n||(t.$message({message:"删除成功",type:"success"}),t.init())}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},resetForm:function(e){this.$refs[e].resetFields(),this.init()},beforeClose:function(e){this.dialogVisible=!1,this.loading=!1,this.$refs.form.resetFields(),"function"===typeof e&&e()},changeEnabled:function(e,t){var n=this;this.$confirm("此操作将".concat(e.enable?"启用":"停用").concat(e.name,"机构, 是否继续"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",cancelButtonClass:"btn-custom-cancel",type:"warning",lockScroll:!1}).then((function(){Object(c["c"])({id:e.id,isEnable:e.isEnable,parentId:e.parentId}).then((function(t){var i=t.code,r=t.msg;i?(e.isEnable=!e.isEnable,n.$message({message:r,type:"error"})):(n.$message({message:"更新成功",type:"success"}),n.init())})).catch((function(t){e.isEnable=!e.isEnable}))})).catch((function(){e.isEnable=!e.isEnable}))}}},b=m,y=n("2877"),h=Object(y["a"])(b,i,r,!1,null,null,null);t["default"]=h.exports},"6f1e":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d}));var i=n("c344"),r={OfficeType:"sys_office_type",OfficeGrade:"sys_office_grade",SysDataScope:"sys_data_scope",SysRoleType:"sys_role_type",SysUserType:"sys_user_type"},a={sys:"/sys/sysDict/find"},s={data:function(){return{OfficeTypeOptsMixins:[]}},methods:{initOfficeTypeOptsMixins:function(){var e=this;return new Promise((function(t,n){Object(i["c"])(a.sys,{name:r.OfficeType}).then((function(n){var i=n.code,r=n.data;i||(e.OfficeTypeOptsMixins=r.dictDetails),t(n)})).catch((function(e){n(e)}))}))}}},o={data:function(){return{OfficeGradeOptsMixins:[]}},methods:{initOfficeGradeOptsMixins:function(){var e=this;return new Promise((function(t,n){Object(i["c"])(a.sys,{name:r.OfficeGrade}).then((function(n){var i=n.code,r=n.data;i||(e.OfficeGradeOptsMixins=r.dictDetails),t(n)})).catch((function(e){n(e)}))}))}}},c={data:function(){return{SysDataScopeOptsMixins:[]}},methods:{initSysDataScopeOptsMixins:function(){var e=this;return new Promise((function(t,n){Object(i["c"])(a.sys,{name:r.SysDataScope}).then((function(n){var i=n.code,r=n.data;i||(e.SysDataScopeOptsMixins=r.dictDetails),t(n)})).catch((function(e){n(e)}))}))}}},l={data:function(){return{SysRoleTypeOptsMixins:[]}},methods:{initSysRoleTypeOptsMixins:function(){var e=this;return new Promise((function(t,n){Object(i["c"])(a.sys,{name:r.SysRoleType}).then((function(n){var i=n.code,r=n.data;i||(e.SysRoleTypeOptsMixins=r.dictDetails),t(n)})).catch((function(e){n(e)}))}))}}},d={data:function(){return{SysUserTypeOptsMixins:[]}},methods:{initSysUserTypeOptsMixins:function(){var e=this;return new Promise((function(t,n){Object(i["c"])(a.sys,{name:r.SysUserType}).then((function(n){var i=n.code,r=n.data;i||(e.SysUserTypeOptsMixins=r.dictDetails),t(n)})).catch((function(e){n(e)}))}))}}}},c344:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var i=n("97af");function r(e,t){return Object(i["a"])({url:e,method:"post",data:t})}function a(e){return Object(i["a"])({url:"/sys/role/listView",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/sys/file/del",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/sys/file/list",method:"post",data:e})}},dc78:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return l}));var i=n("97af");function r(e){return Object(i["a"])({url:"/sys/office/list",method:"post",data:e})}function a(e){return Object(i["a"])({url:"/sys/office/add",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/sys/office/edit",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/sys/office/delete",method:"post",data:e})}function c(e){return Object(i["a"])({url:"/sys/office/childernList",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/sys/office/listTreeView",method:"post",data:e})}}}]);